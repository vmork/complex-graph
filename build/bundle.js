var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(n)}function i(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function l(e){let t;return a(e,(e=>t=e))(),t}function c(e,t,n){e.$$.on_destroy.push(a(t,n))}function u(e,t,n,r){return e[1]&&r?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](r(t))):n.ctx}function h(e,t,n){return e.set(n),t}const d="undefined"!=typeof window;let m=d?()=>window.performance.now():()=>Date.now(),p=d?e=>requestAnimationFrame(e):e;const f=new Set;function g(e){f.forEach((t=>{t.c(e)||(f.delete(t),t.f())})),0!==f.size&&p(g)}function v(e){let t;return 0===f.size&&p(g),{promise:new Promise((n=>{f.add(t={c:e,f:n})})),abort(){f.delete(t)}}}function y(e,t){e.appendChild(t)}function x(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function E(e){const t=w("style");return function(e,t){y(e.head||e,t),t.sheet}(x(e),t),t.sheet}function b(e,t,n){e.insertBefore(t,n||null)}function $(e){e.parentNode&&e.parentNode.removeChild(e)}function S(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function w(e){return document.createElement(e)}function R(e){return document.createTextNode(e)}function A(){return R(" ")}function L(){return R("")}function _(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function k(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function T(e){return""===e?null:+e}function U(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function I(e,t){e.value=null==t?"":t}function N(e,t,n,r){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function O(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}e.selectedIndex=-1}function C(e,t,n){e.classList[n?"add":"remove"](t)}function F(e,t,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(e,n,r,t),s}const M=new Map;let P,B=0;function D(e,t,n,r,s,i,o,a=0){const l=16.666/r;let c="{\n";for(let e=0;e<=1;e+=l){const r=t+(n-t)*i(e);c+=100*e+`%{${o(r,1-r)}}\n`}const u=c+`100% {${o(n,1-n)}}\n}`,h=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,d=x(e),{stylesheet:m,rules:p}=M.get(d)||function(e,t){const n={stylesheet:E(t),rules:{}};return M.set(e,n),n}(d,e);p[h]||(p[h]=!0,m.insertRule(`@keyframes ${h} ${u}`,m.cssRules.length));const f=e.style.animation||"";return e.style.animation=`${f?`${f}, `:""}${h} ${r}ms linear ${s}ms 1 both`,B+=1,h}function z(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),s=n.length-r.length;s&&(e.style.animation=r.join(", "),B-=s,B||p((()=>{B||(M.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&$(t)})),M.clear())})))}function V(e){P=e}function j(){if(!P)throw new Error("Function called outside component initialization");return P}function G(e){j().$$.on_mount.push(e)}function W(){const e=j();return(t,n,{cancelable:r=!1}={})=>{const s=e.$$.callbacks[t];if(s){const i=F(t,n,{cancelable:r});return s.slice().forEach((t=>{t.call(e,i)})),!i.defaultPrevented}return!0}}function q(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const Q=[],H=[],Y=[],X=[],K=Promise.resolve();let J=!1;function Z(e){Y.push(e)}function ee(e){X.push(e)}const te=new Set;let ne,re=0;function se(){if(0!==re)return;const e=P;do{try{for(;re<Q.length;){const e=Q[re];re++,V(e),ie(e.$$)}}catch(e){throw Q.length=0,re=0,e}for(V(null),Q.length=0,re=0;H.length;)H.pop()();for(let e=0;e<Y.length;e+=1){const t=Y[e];te.has(t)||(te.add(t),t())}Y.length=0}while(Q.length);for(;X.length;)X.pop()();J=!1,te.clear(),V(e)}function ie(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Z)}}function oe(){return ne||(ne=Promise.resolve(),ne.then((()=>{ne=null}))),ne}function ae(e,t,n){e.dispatchEvent(F(`${t?"intro":"outro"}${n}`))}const le=new Set;let ce;function ue(){ce={r:0,c:[],p:ce}}function he(){ce.r||s(ce.c),ce=ce.p}function de(e,t){e&&e.i&&(le.delete(e),e.i(t))}function me(e,t,n,r){if(e&&e.o){if(le.has(e))return;le.add(e),ce.c.push((()=>{le.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}const pe={duration:0};function fe(n,r,o,a){const l={direction:"both"};let c=r(n,o,l),u=a?0:1,h=null,d=null,p=null;function f(){p&&z(n,p)}function g(e,t){const n=e.b-u;return t*=Math.abs(n),{a:u,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function y(r){const{delay:i=0,duration:o=300,easing:a=t,tick:l=e,css:y}=c||pe,x={start:m()+i,b:r};r||(x.group=ce,ce.r+=1),h||d?d=x:(y&&(f(),p=D(n,u,r,o,i,a,y)),r&&l(0,1),h=g(x,o),Z((()=>ae(n,r,"start"))),v((e=>{if(d&&e>d.start&&(h=g(d,o),d=null,ae(n,h.b,"start"),y&&(f(),p=D(n,u,h.b,h.duration,0,a,c.css))),h)if(e>=h.end)l(u=h.b,1-u),ae(n,h.b,"end"),d||(h.b?f():--h.group.r||s(h.group.c)),h=null;else if(e>=h.start){const t=e-h.start;u=h.a+h.d*a(t/h.duration),l(u,1-u)}return!(!h&&!d)})))}return{run(e){i(c)?oe().then((()=>{c=c(l),y(e)})):y(e)},end(){f(),h=d=null}}}function ge(e,t){me(e,1,1,(()=>{t.delete(e.key)}))}function ve(e,t,n,r,s,i,o,a,l,c,u,h){let d=e.length,m=i.length,p=d;const f={};for(;p--;)f[e[p].key]=p;const g=[],v=new Map,y=new Map;for(p=m;p--;){const e=h(s,i,p),a=n(e);let l=o.get(a);l?r&&l.p(e,t):(l=c(a,e),l.c()),v.set(a,g[p]=l),a in f&&y.set(a,Math.abs(p-f[a]))}const x=new Set,E=new Set;function b(e){de(e,1),e.m(a,u),o.set(e.key,e),u=e.first,m--}for(;d&&m;){const t=g[m-1],n=e[d-1],r=t.key,s=n.key;t===n?(u=t.first,d--,m--):v.has(s)?!o.has(r)||x.has(r)?b(t):E.has(s)?d--:y.get(r)>y.get(s)?(E.add(r),b(t)):(x.add(s),d--):(l(n,o),d--)}for(;d--;){const t=e[d];v.has(t.key)||l(t,o)}for(;m;)b(g[m-1]);return g}function ye(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function xe(e){e&&e.c()}function Ee(e,t,r,o){const{fragment:a,after_update:l}=e.$$;a&&a.m(t,r),o||Z((()=>{const t=e.$$.on_mount.map(n).filter(i);e.$$.on_destroy?e.$$.on_destroy.push(...t):s(t),e.$$.on_mount=[]})),l.forEach(Z)}function be(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function $e(e,t){-1===e.$$.dirty[0]&&(Q.push(e),J||(J=!0,K.then(se)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Se(t,n,i,o,a,l,c,u=[-1]){const h=P;V(t);const d=t.$$={fragment:null,ctx:[],props:l,update:e,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(h?h.$$.context:[])),callbacks:r(),dirty:u,skip_bound:!1,root:n.target||h.$$.root};c&&c(d.root);let m=!1;if(d.ctx=i?i(t,n.props||{},((e,n,...r)=>{const s=r.length?r[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=s)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](s),m&&$e(t,e)),n})):[],d.update(),m=!0,s(d.before_update),d.fragment=!!o&&o(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach($)}else d.fragment&&d.fragment.c();n.intro&&de(t.$$.fragment),Ee(t,n.target,n.anchor,n.customElement),se()}V(h)}class we{$destroy(){be(this,1),this.$destroy=e}$on(t,n){if(!i(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function Re(e,t,n,r){return new(n||(n=Promise))((function(s,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function a(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))}const Ae={setEventListeners:!0},Le=new Event("camera");class _e{constructor(e,t=Ae){this.options=Ae,this.canvas=e,this.options=t,this.reset(),t.setEventListeners&&(this.canvas.addEventListener("wheel",(e=>{e.preventDefault(),this.scaleAt(e.offsetX,e.offsetY,Math.pow(1.001,e.deltaY))})),this.canvas.addEventListener("mousemove",(e=>{1==e.buttons&&this.move(e.movementX,e.movementY)})))}w(){return this.canvas.width}h(){return this.canvas.height}aspect(){return this.w()/this.h()}reset(){this.origin={x:0,y:0},this.scale={x:this.aspect(),y:1},this.canvas.dispatchEvent(Le)}screenToWorld(e,t){return{x:this.origin.x+this.scale.x*(2*e/this.canvas.width-1),y:this.origin.y+this.scale.y*(-2*t/this.canvas.height+1)}}worldToScreen(e,t){return{x:this.canvas.width/2*(1+(e-this.origin.x)/this.scale.x),y:this.canvas.height/2*(1-(t-this.origin.y)/this.scale.y)}}scaleAt(e,t,n){const r=this.screenToWorld(e,t),s=1-n;this.origin.x+=s*(r.x-this.origin.x),this.origin.y+=s*(r.y-this.origin.y),this.scale.x*=n,this.scale.y*=n,this.canvas.dispatchEvent(Le)}move(e,t){this.origin.x-=e/this.w()*this.scale.x*2,this.origin.y+=t/this.h()*this.scale.y*2,this.canvas.dispatchEvent(Le)}getWorldMatrix(){return[this.scale.x,0,0,0,this.scale.y,0,this.origin.x,this.origin.y,1]}getInverseWorldMatrix(){return[1/this.scale.x,0,0,0,1/this.scale.y,0,-this.origin.x/this.scale.x,-this.origin.y/this.scale.y,1]}}class ke extends Error{constructor(e,t,n){super(e),this.name="ShaderError",this.shaderType=t,this.fileName=n}toString(){let e=35633==this.shaderType?"vertex":"fragment";return`glsl error in ${this.fileName} (${e}):\n${this.message}`}}function Te(e){const t=e.clientWidth,n=e.clientHeight,r=e.width!==t||e.height!==n;return r&&(e.width=t,e.height=n),r}function Ue(e){return Re(this,void 0,void 0,(function*(){let t=yield fetch(e);return yield t.text()}))}class Ie{constructor(e,t,n=null,r=null){this.name=e,this.type=t,this.value=n,this.loc=r}}function Ne(e){return Re(this,void 0,void 0,(function*(){let t=e.split("\n"),n="";for(let e of t)if(n+=e+"\n",e.trim().startsWith("//#include")){let t=e.split(" ")[1];n+=(yield Ue(`shaders/${t}`))+"\n"}return n}))}function Oe(e,t,n){let r=new RegExp(`//#${t}`);return e.replace(r,`//#${t}\n${n}`)}function Ce(e,t){return Oe(e,"UFUNC",t)}function Fe(e,t){let n="";for(let e of t)n+=`uniform ${e.type} ${e.name};\n`;return Oe(e,"UNIFORMS",n)}class Me{constructor(e,t){this.gl=e,this.id=e.createProgram(),this.uniforms=new Map,this.addUniforms(t)}compileShader(e,t,n){const r=this.gl;let s=r.createShader(e);if(r.shaderSource(s,t),r.compileShader(s),!r.getShaderParameter(s,r.COMPILE_STATUS)){let t=r.getShaderInfoLog(s);throw r.deleteShader(s),this.isCompiled=!1,new ke(t,e,n)}return s}compileFromUrls(e,t,n){return Re(this,void 0,void 0,(function*(){this.vertUrl=e,this.fragUrl=t;let r=yield Ue(e),s=yield Ue(t);r=yield Ne(r),s=yield Ne(s),this.vertSrcRaw=r,this.fragSrcRaw=s;try{return this.compile(r,s,n)}catch(e){if(e instanceof ke)throw new Error(e.toString())}}))}compile(e,t,n){const r=this.gl;e=Fe(e=Ce(e,n),this.uniforms.values()),t=Fe(t=Ce(t,n),this.uniforms.values()),this.isCompiled=!0;const s=this.compileShader(r.VERTEX_SHADER,e,this.vertUrl),i=this.compileShader(r.FRAGMENT_SHADER,t,this.fragUrl);return r.attachShader(this.id,s),r.attachShader(this.id,i),r.linkProgram(this.id),r.getProgramParameter(this.id,r.LINK_STATUS)?(this.setUniformLocations(),this.vertShader=s,this.fragShader=i,this.id):(console.error("Error in creating program: ",r.getProgramInfoLog(this.id)),void r.deleteProgram(this.id))}recompile(e){const t=this.gl;this.isCompiled&&(t.detachShader(this.id,this.vertShader),t.deleteShader(this.vertShader),t.detachShader(this.id,this.fragShader),t.deleteShader(this.fragShader)),this.compile(this.vertSrcRaw,this.fragSrcRaw,e)}addUniforms(e){for(let t of e)this.addUniform(t)}addUniform(e){this.uniforms.has(e.name)?console.error(`Uniform ${e.name} already exists in program`):this.uniforms.set(e.name,e)}deleteUniform(e){this.uniforms.delete(e)}setUniformValue(e,t,n=!1){const r=this.uniforms.get(e);r.value=t,n&&this.bindUniform(r)}getUniformValue(e){return this.uniforms.get(e).value}logUniforms(){console.table(Array.from(this.uniforms.values()).map((e=>[e.name,e.value])))}setUniformLocations(){for(let e of this.uniforms.values())e.loc=this.gl.getUniformLocation(this.id,e.name)}bindUniform(e){const t=this.gl;"float"===e.type?t.uniform1f(e.loc,e.value):"vec2"===e.type?t.uniform2fv(e.loc,e.value):"vec3"===e.type?t.uniform3fv(e.loc,e.value):"vec4"===e.type?t.uniform4fv(e.loc,e.value):"int"===e.type?t.uniform1i(e.loc,e.value):"mat2"===e.type?t.uniformMatrix2fv(e.loc,!1,e.value):"mat3"===e.type?t.uniformMatrix3fv(e.loc,!1,e.value):"bool"===e.type?t.uniform1i(e.loc,e.value):console.error("Unsupported uniform type: "+e.type)}bindAllUniforms(){for(let e of this.uniforms.values())this.bindUniform(e)}}var Pe;!function(e){e[e.IDENTIFIER=0]="IDENTIFIER",e[e.LITERAL_REAL=1]="LITERAL_REAL",e[e.LITERAL_IMAG=2]="LITERAL_IMAG",e[e.TRUE=3]="TRUE",e[e.FALSE=4]="FALSE",e[e.LPAREN=5]="LPAREN",e[e.RPAREN=6]="RPAREN",e[e.PLUS=7]="PLUS",e[e.MINUS=8]="MINUS",e[e.STAR=9]="STAR",e[e.SLASH=10]="SLASH",e[e.COMMA=11]="COMMA",e[e.BANG=12]="BANG",e[e.EQUAL=13]="EQUAL",e[e.LESS=14]="LESS",e[e.GREATER=15]="GREATER",e[e.HASH=16]="HASH",e[e.COLON=17]="COLON",e[e.CARET=18]="CARET",e[e.SEMICOLON=19]="SEMICOLON",e[e.BANG_EQUAL=20]="BANG_EQUAL",e[e.EQUAL_EQUAL=21]="EQUAL_EQUAL",e[e.COLON_EQUAL=22]="COLON_EQUAL",e[e.LESS_EQUAL=23]="LESS_EQUAL",e[e.GREATER_EQUAL=24]="GREATER_EQUAL",e[e.DOUBLE_BAR=25]="DOUBLE_BAR",e[e.DOUBLE_AMPERSAND=26]="DOUBLE_AMPERSAND",e[e.ARROW=27]="ARROW",e[e.DOUBLE_DOT=28]="DOUBLE_DOT",e[e.AND=29]="AND",e[e.OR=30]="OR",e[e.IF=31]="IF",e[e.ELSE=32]="ELSE",e[e.ELIF=33]="ELIF",e[e.RETURN=34]="RETURN",e[e.BREAK=35]="BREAK",e[e.FOR=36]="FOR",e[e.WHILE=37]="WHILE",e[e.NEWLINE=38]="NEWLINE",e[e.INDENT=39]="INDENT",e[e.DEDENT=40]="DEDENT",e[e.EOF=41]="EOF"}(Pe||(Pe={}));const Be=new Map(Object.entries({"(":Pe.LPAREN,")":Pe.RPAREN,"+":Pe.PLUS,"-":Pe.MINUS,"*":Pe.STAR,"/":Pe.SLASH,"^":Pe.CARET,";":Pe.SEMICOLON,",":Pe.COMMA,"!":Pe.BANG,":":Pe.COLON,"=":Pe.EQUAL,"<":Pe.LESS,">":Pe.GREATER,"#":Pe.HASH,"&&":Pe.DOUBLE_AMPERSAND,"||":Pe.DOUBLE_BAR,"==":Pe.EQUAL_EQUAL,"!=":Pe.BANG_EQUAL,"<=":Pe.LESS_EQUAL,">=":Pe.GREATER_EQUAL,":=":Pe.COLON_EQUAL,"..":Pe.DOUBLE_DOT,"->":Pe.ARROW,and:Pe.AND,or:Pe.OR,if:Pe.IF,else:Pe.ELSE,elif:Pe.ELIF,return:Pe.RETURN,break:Pe.BREAK,for:Pe.FOR,while:Pe.WHILE,true:Pe.TRUE,false:Pe.FALSE}));class De{constructor(e,t,n,r=null){this.type=e,this.lexeme=t,this.line=n,this.literal=r}toString(){return{type:Pe[this.type],lexeme:this.lexeme,line:this.line,literal:this.literal}}}class ze extends Error{constructor(e,t=null,n=null){super(e),this.message=e,this.line=t,this.lexeme=n,Object.setPrototypeOf(this,ze.prototype)}toString(){return"oije"}}class Ve extends ze{constructor(e,t=null,n=null){super(e),this.message=e,this.line=t,this.lexeme=n,Object.setPrototypeOf(this,Ve.prototype)}toString(){return`SYNTAX ERROR: line ${this.line} at '${this.lexeme}': ${this.message}`}}class je extends ze{constructor(e,t=null,n=null){super(e),this.message=e,this.line=t,this.lexeme=n,Object.setPrototypeOf(this,je.prototype)}toString(){return`TYPE ERROR: ${this.message}`}}const Ge=new Set(["(",")","+","*","/",",","^",";"]),We=new Set(["-",":","!","=","<",">","."]);function qe(e){return/[0-9]/.test(e)}class Qe{constructor(e){this.cur=0,this.line=1,this.lexemeStart=0,this.tokens=[],this.indentLevels=[],this.source=e,this.indentLevels.push(this.getInitialIndent())}isAtEnd(){return this.cur>=this.source.length}peek(){return this.isAtEnd()?"\0":this.source[this.cur]}peek2(){return this.cur+1>=this.source.length?"\0":this.source[this.cur+1]}advance(){return this.source[this.cur++]}match(e){return this.peek()===e&&(this.cur+=1,!0)}currentLexeme(){return this.source.substring(this.lexemeStart,this.cur)}addToken(e,t=null){this.tokens.push(new De(e,this.currentLexeme(),this.line,t))}scan(){for(;this.cur<this.source.length;)this.lexemeStart=this.cur,this.scanToken();return this.tokens}scanToken(){const e=this.advance();if(Ge.has(e))this.addToken(Be.get(e));else{if(We.has(e)){const t=this.peek();if(Be.has(e+t))return this.cur+=1,void this.addToken(Be.get(e+t));if(Be.has(e))return void this.addToken(Be.get(e))}if("#"!==e)if("\n"!==e){if(" "!==e&&"\r"!==e&&"\t"!==e)if(qe(e))this.scanNumber();else{if(!function(e){return/[_a-zA-Z]/.test(e)}(e))throw new Ve("Unexcpected character: "+e,this.line);this.scanIdentifier()}}else this.scanNewline();else this.scanComment()}}scanComment(){for(;"\n"!=this.peek()&&!this.isAtEnd();)this.cur+=1}getInitialIndent(){let e=this.getIndentLevel();for(;this.match("\n");)e=this.getIndentLevel();return e}getIndentLevel(){let e=0;for(;!this.isAtEnd();){const t=this.peek();if(" "===t)e+=1;else{if("\t"!==t)break;e+=4}this.cur+=1}return e}scanNewline(){this.line+=1;const e=this.indentLevels[this.indentLevels.length-1],t=this.getIndentLevel();if("#"!==this.peek()){if("\n"!==this.peek()&&"\0"!==this.peek())if(this.addToken(Pe.NEWLINE),t>e)this.addToken(Pe.INDENT),this.indentLevels.push(t);else if(t<e){for(;this.indentLevels.length>0&&this.indentLevels[this.indentLevels.length-1]>t;)this.addToken(Pe.DEDENT),this.indentLevels.pop();if(this.indentLevels[this.indentLevels.length-1]!==t)throw new Ve("Dedent level doesnt match previous indents",this.line)}}else this.scanComment()}consumeDigits(){for(;qe(this.peek());)this.cur+=1}scanNumber(){this.consumeDigits(),"."===this.peek()&&"."!==this.peek2()&&(this.cur+=1,this.consumeDigits());const e=Number.parseFloat(this.currentLexeme());"i"===this.peek()?(this.addToken(Pe.LITERAL_IMAG,e),this.cur+=1):this.addToken(Pe.LITERAL_REAL,e)}scanIdentifier(){for(;e=this.peek(),/[_a-zA-Z0-9]/.test(e);)this.cur+=1;var e;const t=this.currentLexeme();"i"===t?this.addToken(Pe.LITERAL_IMAG,1):Be.has(t)?this.addToken(Be.get(t)):this.addToken(Pe.IDENTIFIER,t)}}var He,Ye;!function(e){e[e.Literal=0]="Literal",e[e.Unary=1]="Unary",e[e.Binary=2]="Binary",e[e.Grouping=3]="Grouping",e[e.Variable=4]="Variable",e[e.FuncCall=5]="FuncCall",e[e.StmtList=6]="StmtList",e[e.Declaration=7]="Declaration",e[e.Assignment=8]="Assignment",e[e.For=9]="For",e[e.While=10]="While",e[e.If=11]="If",e[e.FuncDef=12]="FuncDef",e[e.Return=13]="Return",e[e.Break=14]="Break"}(He||(He={})),function(e){e[e.Bool=0]="Bool",e[e.Real=1]="Real",e[e.Imag=2]="Imag"}(Ye||(Ye={}));const Xe=new Map([[Ye.Real,"float"],[Ye.Imag,"vec2"],[Ye.Bool,"bool"]]),Ke=new Map([["float",Ye.Real],["vec2",Ye.Imag],["bool",Ye.Bool]]),Je=new De(Pe.EOF,null,-1);class Ze{constructor(e){this.cur=0,this.tokens=e}error(e){const t=this.isAtEnd()?this.prev():this.peek();throw new Ve(e,t.line,t.lexeme)}isAtEnd(){return this.cur>=this.tokens.length}peek(){return this.isAtEnd()?Je:this.tokens[this.cur]}prev(){return this.tokens[this.cur-1]}backup(){this.cur-=1}advance(){return this.isAtEnd()?Je:this.tokens[this.cur++]}match(e,t=!0){const n=this.peek();return!!e.some((e=>n.type===e))&&(!t||this.advance())}matchOrError(e,t){const n=this.match(e);if(n)return n;this.error(t)}parse(){return this.stmtList()}stmtList(){let e=[];for(;!this.isAtEnd()&&this.peek().type!==Pe.DEDENT;)e.push(this.statement());return{nodeType:He.StmtList,statements:e}}statement(){let e;switch(this.peek().type){case Pe.IDENTIFIER:e=this.assignmentOrDeclarationOrFuncdef();break;case Pe.IF:this.advance(),e=this.ifStmt();break;case Pe.FOR:this.advance(),e=this.forStmt();break;case Pe.WHILE:this.advance(),e=this.whileStmt();break;case Pe.RETURN:this.advance(),e=this.returnStmt();break;case Pe.BREAK:this.advance(),e=this.breakStmt();break;case Pe.INDENT:this.error("Unexpected indent");default:this.error("Excpected statement")}return[He.If,He.For,He.While,He.FuncDef].includes(e.nodeType)||this.matchOrError([Pe.NEWLINE,Pe.SEMICOLON,Pe.EOF],"Unexcpected token "+this.peek().lexeme),e}indentedBlock(){this.matchOrError([Pe.INDENT],"Excpected indent");const e=this.stmtList();return this.matchOrError([Pe.DEDENT,Pe.EOF],"Expected dedent"),e}indentedBlockOrOnelineStmt(){return this.match([Pe.NEWLINE])?this.indentedBlock():{nodeType:He.StmtList,statements:[this.statement()]}}assignmentOrDeclarationOrFuncdef(){const e=this.advance().lexeme;if(this.match([Pe.LPAREN]))return this.functionDefinition(e);const t=this.matchOrError([Pe.EQUAL,Pe.COLON_EQUAL],"Excpected assignment or declaration"),n=this.expression();return t.type===Pe.EQUAL?{nodeType:He.Assignment,name:e,value:n}:{nodeType:He.Declaration,name:e,value:n}}identifier(){return this.matchOrError([Pe.IDENTIFIER],"Expected identifier"),this.prev().lexeme}parameterList(){if(this.match([Pe.RPAREN]))return[];let e=[this.identifier()];for(;!this.match([Pe.RPAREN]);)this.matchOrError([Pe.COMMA],"Expected ',' or ')' in parameter list"),e.push(this.identifier());return e}argumentList(){if(this.match([Pe.RPAREN]))return[];let e=[this.expression()];for(;!this.match([Pe.RPAREN]);)this.matchOrError([Pe.COMMA],"Expected ',' or ')' in argument list"),e.push(this.expression());return e}functionDefinition(e){let t,n=this.parameterList();if(this.matchOrError([Pe.COLON_EQUAL],"Expected ':=' in function definition"),this.match([Pe.NEWLINE]))t=this.indentedBlock();else{let e={nodeType:He.Return,value:this.expression()};t={nodeType:He.StmtList,statements:[e]},this.matchOrError([Pe.NEWLINE,Pe.SEMICOLON,Pe.EOF],"Unexcpected token "+this.peek().lexeme)}return{nodeType:He.FuncDef,name:e,params:n,body:t}}ifStmt(){const e=this.expression();this.matchOrError([Pe.COLON],"Excpected ':' in if-statement");const t=this.indentedBlockOrOnelineStmt();let n;return this.match([Pe.ELIF])?n={nodeType:He.StmtList,statements:[this.ifStmt()]}:this.match([Pe.ELSE])&&(this.matchOrError([Pe.COLON],"Expected ':' after else"),n=this.indentedBlockOrOnelineStmt()),{nodeType:He.If,condition:e,mainBranch:t,elseBranch:n}}whileStmt(){const e=this.expression();this.matchOrError([Pe.COLON],"Excpected ':' in while-statement");const t=this.indentedBlockOrOnelineStmt();return{nodeType:He.While,condition:e,body:t}}forStmt(){const e=this.matchOrError([Pe.IDENTIFIER],"Expected identifier in for-statement").literal;this.matchOrError([Pe.EQUAL],"Expected '=' in for-statement");const t=this.expression();this.matchOrError([Pe.DOUBLE_DOT],"Expected range (start..end..[step])");const n=this.expression();let r={nodeType:He.Literal,value:1,dataType:Ye.Real};this.match([Pe.DOUBLE_DOT])&&(r=this.expression()),this.matchOrError([Pe.COLON],"Excpected ':' in for-statement");const s=this.indentedBlockOrOnelineStmt();return{nodeType:He.For,loopvar:e,start:t,end:n,step:r,body:s}}returnStmt(){const e=this.expression();return{nodeType:He.Return,value:e}}breakStmt(){return{nodeType:He.Break}}expression(){return this.logical()}_binary(e,t){let n=t();for(;this.match(e);){const e=this.prev(),r=t();n={nodeType:He.Binary,left:n,op:e,right:r}}return n}logical(){return this._binary([Pe.AND,Pe.OR],(()=>this.equality()))}equality(){return this._binary([Pe.EQUAL_EQUAL,Pe.BANG_EQUAL],(()=>this.comparision()))}comparision(){return this._binary([Pe.LESS,Pe.LESS_EQUAL,Pe.GREATER,Pe.GREATER_EQUAL],(()=>this.term()))}term(){return this._binary([Pe.PLUS,Pe.MINUS],(()=>this.factor()))}factor(){return this._binary([Pe.STAR,Pe.SLASH],(()=>this.unary()))}unary(){if(this.match([Pe.MINUS,Pe.BANG])){const e=this.prev(),t=this.unary();return{nodeType:He.Unary,op:e,expr:t}}return this.implicitMultiplication()}implicitMultiplication(){if(this.match([Pe.LITERAL_IMAG,Pe.LITERAL_REAL,Pe.LPAREN,Pe.IDENTIFIER],!1)){let e=this.power();for(;this.match([Pe.LPAREN,Pe.IDENTIFIER],!1);){let t=this.power();e={nodeType:He.Binary,op:new De(Pe.STAR,"*",-1),left:e,right:t}}return e}return this.power()}power(){return this._binary([Pe.CARET],(()=>this.functionCall()))}functionCall(){const e=this.primary();if(e.nodeType===He.Variable&&this.match([Pe.LPAREN])){const t=this.argumentList();return{nodeType:He.FuncCall,callee:e,args:t}}return e}_grouping(){const e=this.expression();return this.matchOrError([Pe.RPAREN],"Unmatched opening parenthesis"),{nodeType:He.Grouping,expr:e}}primary(){return this.match([Pe.TRUE])?{nodeType:He.Literal,value:!0,dataType:Ye.Bool}:this.match([Pe.FALSE])?{nodeType:He.Literal,value:!1,dataType:Ye.Bool}:this.match([Pe.LITERAL_REAL])?{nodeType:He.Literal,value:this.prev().literal,dataType:Ye.Real}:this.match([Pe.LITERAL_IMAG])?{nodeType:He.Literal,value:this.prev().literal,dataType:Ye.Imag}:this.match([Pe.IDENTIFIER])?{nodeType:He.Variable,name:this.prev().literal}:this.match([Pe.LPAREN])?this._grouping():void this.error("Expected expression")}}function et(e,t){return 0===t?[[]]:e.flatMap((n=>et(e,t-1).map((e=>[n].concat(e)))))}function tt(e,t){return e.length===t.length&&JSON.stringify(e)==JSON.stringify(t)}const nt=" ".repeat(4);class rt{constructor(e){this.indentLevel=0,this.tree=e}_indentStr(){return nt.repeat(this.indentLevel)}_bracedBlock(e){this.indentLevel+=1;const t=this.stmtList(e);return this.indentLevel-=1,`{\n${t}\n${this._indentStr()}}`}_number(e){let t=e.toString();return t.includes(".")?t:t+".0"}transform(e=this.tree){switch(e.nodeType){case He.StmtList:return this.stmtList(e);case He.Declaration:return this.declaration(e);case He.Assignment:return this.assignment(e);case He.If:return this.if(e);case He.For:return this.for(e);case He.While:return this.while(e);case He.FuncDef:return this.funcDef(e);case He.Break:return this.break(e);case He.Return:return this.return(e);case He.Grouping:return this.grouping(e);case He.Binary:return this.binary(e);case He.Unary:return this.unary(e);case He.Literal:return this.literal(e);case He.Variable:return e.name;case He.FuncCall:return this.funcCall(e)}}stmtList(e){let t=[];for(let n of e.statements){let e=this.transform(n);e.endsWith("}")||(e+=";"),t.push(e)}return this._indentStr()+t.join("\n"+this._indentStr())}declaration(e){return`${Xe.get(e.value.dataType)} ${e.name} = ${this.transform(e.value)}`}assignment(e){return`${e.name} = ${this.transform(e.value)}`}if(e){let t=`if (${this.transform(e.condition)}) ${this._bracedBlock(e.mainBranch)}`;return e.elseBranch&&(t+=` else ${this._bracedBlock(e.elseBranch)}`),t}for(e){let{loopvar:t,start:n,end:r,step:s,body:i}=e;return`for (float ${t} = ${this.transform(n)}; ${t} <= ${this.transform(r)}; ${t} += ${this.transform(s)}) ${this._bracedBlock(i)}`}while(e){return`while (${this.transform(e.condition)}) ${this._bracedBlock(e.body)}`}funcDef(e){let{name:t,params:n,body:r,dataType:s}=e,i=Xe.get(s),o=[];for(let e of et(["vec2"],n.length)){let s=`${i} ${t}(${n.map(((t,n)=>e[n]+" "+t)).join(", ")}) ${this._bracedBlock(r)}`;o.push(s)}return o.join("\n")}break(e){return"break"}return(e){return`return ${this.transform(e.value)}`}grouping(e){return`(${this.transform(e.expr)})`}binary(e){const t=this.transform(e.left),n=this.transform(e.right),r=e.left.dataType,s=e.right.dataType,i=e.op.lexeme,o=`${t} ${i} ${n}`;switch(i){case"-":case"+":return r===Ye.Real&&s===Ye.Imag?`vec2(${t}, 0.0) ${i} ${n}`:r===Ye.Imag&&s===Ye.Real?`${t} ${i} vec2(${n}, 0.0)`:o;case"*":return r===Ye.Imag&&s===Ye.Imag?`Mul(${t}, ${n})`:o;case"/":return s===Ye.Real?o:`Div(${t}, ${n})`;case"^":return"e"===t?`Exp(${n})`:`Pow(${t}, ${n})`;case"<":case">":case"<=":case">=":return o}}unary(e){return`${e.op.lexeme}${this.transform(e.expr)}`}funcCall(e){const t=e.args.map((e=>this.transform(e)));return`${e.callee.name}(${t.join(", ")})`}literal(e){const{dataType:t,value:n}=e;switch(t){case Ye.Bool:return!0===n?"true":"false";case Ye.Real:return this._number(n);case Ye.Imag:return`vec2(0.0, ${this._number(n)})`}}}const st=new Map(Object.entries({e:{type:Ye.Real,value:Math.exp(1)},pi:{type:Ye.Real,value:Math.PI}})),it={Re_Re_or_Re_Im:[{out:Ye.Real,in:[Ye.Real]},{out:Ye.Real,in:[Ye.Imag]}],Re_Re_or_Im_Im:[{out:Ye.Real,in:[Ye.Real]},{out:Ye.Imag,in:[Ye.Imag]}]},ot=new Map(Object.entries({re:{glslName:"Re",signatures:it.Re_Re_or_Re_Im},im:{glslName:"Im",signatures:it.Re_Re_or_Re_Im},abs:{glslName:"Abs",signatures:it.Re_Re_or_Re_Im},arg:{glslName:"Arg",signatures:it.Re_Re_or_Re_Im},conj:{glslName:"Conj",signatures:it.Re_Re_or_Im_Im},exp:{glslName:"Exp",signatures:it.Re_Re_or_Im_Im},log:{glslName:"Log",signatures:it.Re_Re_or_Im_Im},sqrt:{glslName:"Sqrt",signatures:it.Re_Re_or_Im_Im},sin:{glslName:"Sin",signatures:it.Re_Re_or_Im_Im},cos:{glslName:"Cos",signatures:it.Re_Re_or_Im_Im},tan:{glslName:"Tan",signatures:it.Re_Re_or_Im_Im},arctan:{glslName:"Arctan",signatures:it.Re_Re_or_Im_Im},arcsin:{glslName:"Arcsin",signatures:it.Re_Re_or_Im_Im},arccos:{glslName:"Arccos",signatures:it.Re_Re_or_Im_Im}}));class at{constructor(e,t){this.insideFuncDef=!1,this.tree=e,this.currentScope={env:t||new Map,parent:null},this.declaredFunctions=new Map}withNewScope(e){const t=this.currentScope;this.currentScope={env:new Map,parent:t};const n=e();return this.currentScope=t,n}lookupVar(e){let t=this.currentScope;for(;t;){const n=t.env.get(e);if(n)return n;t=t.parent}return st.get(e)}declareVar(e,t){(st.has(e)||this.currentScope.env.has(e))&&this.error(`Cannot redeclare variable ${e}`),this.currentScope.env.set(e,{type:t})}error(e){throw new je(e)}assertType(e,t,n){e.forEach((e=>{t.includes(e)||this.error(n)}))}assertNumeric(e,t){this.assertType(e,[Ye.Real,Ye.Imag],t)}assertBool(e,t){this.assertType(e,[Ye.Bool],t)}typecheckTree(){this.typecheck(this.tree);let e=this.declaredFunctions.get(lt.mainFunctionName);e||this.error("Must declare a main function f(z)");const t={in:[Ye.Imag],out:Ye.Imag};tt(e.signatures,[t])||this.error("Main function must be of type Imag -> Imag")}typecheck(e){let t;switch(e.nodeType){case He.StmtList:t=this.stmtList(e);break;case He.Declaration:t=this.declaration(e);break;case He.Assignment:t=this.assignment(e);break;case He.If:t=this.if(e);break;case He.For:t=this.for(e);break;case He.While:t=this.while(e);break;case He.FuncDef:t=this.funcDef(e);break;case He.Break:return;case He.Return:t=this.return(e);break;case He.Grouping:t=this.grouping(e);break;case He.Binary:t=this.binary(e);break;case He.Unary:t=this.unary(e);break;case He.Literal:t=this.literal(e);break;case He.Variable:t=this.variable(e);break;case He.FuncCall:t=this.funcCall(e)}return e.dataType=t,t}stmtList(e){e.statements.forEach(this.typecheck.bind(this))}declaration(e){const t=this.typecheck(e.value);this.declareVar(e.name,t)}assignment(e){st.has(e.name)&&this.error(`Cannot reassign builtin variable ${e.name}`);let t=this.lookupVar(e.name);t||this.error(`Cannot assign to undeclared variable ${e.name}`);const n=this.typecheck(e.value);t.type!==n&&this.error(`Cannot reassign ${e.name} from type ${Ye[t.type]} to ${Ye[n]}`)}if(e){this.assertType([this.typecheck(e.condition)],[Ye.Bool],"Condition in if-statement is not of type Bool"),this.withNewScope((()=>this.typecheck(e.mainBranch))),e.elseBranch&&this.withNewScope((()=>this.typecheck(e.elseBranch)))}for(e){const[t,n,r]=[e.start,e.end,e.step].map((e=>this.typecheck(e)));this.assertType([t,n,r],[Ye.Real],"For-loop bounds are not of type Real"),this.withNewScope((()=>{this.declareVar(e.loopvar,Ye.Real),this.typecheck(e.body)}))}while(e){this.assertType([this.typecheck(e.condition)],[Ye.Bool],"Condition in while-loop is not of type Bool"),this.withNewScope((()=>this.typecheck(e.body)))}funcDef(e){(this.declaredFunctions.has(e.name)||ot.has(e.name))&&this.error(`Cannot redeclare function ${e.name}`),this.insideFuncDef=!0,this.currentFunction={name:e.name,returnType:null};const t=e.params.map((e=>Ye.Imag));this.withNewScope((()=>{e.params.forEach(((e,n)=>this.declareVar(e,t[n]))),this.typecheck(e.body)}));const n=this.currentFunction.returnType;n||this.error(`Function ${e.name} doesnt return a value`);const r={in:t,out:n};return this.declaredFunctions.set(e.name,{signatures:[r]}),this.insideFuncDef=!1,n}return(e){const t=this.typecheck(e.value);this.currentFunction.returnType&&this.currentFunction.returnType!==t&&this.error(`Function ${this.currentFunction.name} has multiple possible return types`),this.currentFunction.returnType=t}grouping(e){return this.typecheck(e.expr)}binary(e){const{left:t,right:n,op:r}=e,s=this.typecheck(t),i=this.typecheck(n);return["+","-","*","/","^"].includes(r.lexeme)?(this.assertNumeric([s,i],`Wrong operand types for ${r.lexeme}: ${Ye[s]}, ${Ye[i]}`),s===Ye.Real&&i===Ye.Real?Ye.Real:Ye.Imag):["<",">","<=",">="].includes(r.lexeme)?(this.assertType([s,i],[Ye.Real],`Wrong operand types for ${r.lexeme}: ${Ye[s]}, ${Ye[i]}`),Ye.Bool):void 0}unary(e){const t=this.typecheck(e.expr),n=e.op.lexeme,r=`Wrong operand type for unary ${n}: ${Ye[t]}`;return"-"===n&&this.assertNumeric([t],r),"!"===n&&this.assertBool([t],r),t}literal(e){return console.assert(void 0!==e.dataType),e.dataType}variable(e){let t=this.lookupVar(e.name);return t||this.error(`Undeclared variable ${e.name}`),t.type}funcCall(e){let t=e.callee.name,n=ot.get(t);n?e.callee.name=n.glslName:n=this.declaredFunctions.get(t),n||this.error(`Undeclared function ${t}`);const r=e.args.map((e=>this.typecheck(e)));for(let e of n.signatures)if(tt(e.in,r))return e.out;this.error(`Wrong argument types for ${t}: [${r.map((e=>Ye[e])).join(", ")}]`)}}const lt={maxFunctionParams:5,mainFunctionName:"f"};const ct=[];function ut(t,n=e){let r;const s=new Set;function i(e){if(o(t,e)&&(t=e,r)){const e=!ct.length;for(const e of s)e[1](),ct.push(e,t);if(e){for(let e=0;e<ct.length;e+=2)ct[e][0](ct[e+1]);ct.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(o,a=e){const l=[o,a];return s.add(l),1===s.size&&(r=n(i)||e),o(t),()=>{s.delete(l),0===s.size&&(r(),r=null)}}}}const ht=ut([]),dt=ut([]),mt=ut([]);function pt(e){e.target.style.position="absolute",e.target.style.width="100%"}function ft({currentTarget:e,relatedTarget:t},n){t instanceof HTMLElement&&e instanceof HTMLElement&&e.contains(t)||n()}function gt(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}function vt(){return`#${Math.floor(16777215*Math.random()).toString(16).padEnd(6,"0")}`}let yt;const xt=new Uint8Array(16);function Et(){if(!yt&&(yt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!yt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return yt(xt)}const bt=[];for(let e=0;e<256;++e)bt.push((e+256).toString(16).slice(1));var $t={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function St(e,t,n){if($t.randomUUID&&!t&&!e)return $t.randomUUID();const r=(e=e||{}).random||(e.rng||Et)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return bt[e[t+0]]+bt[e[t+1]]+bt[e[t+2]]+bt[e[t+3]]+"-"+bt[e[t+4]]+bt[e[t+5]]+"-"+bt[e[t+6]]+bt[e[t+7]]+"-"+bt[e[t+8]]+bt[e[t+9]]+"-"+bt[e[t+10]]+bt[e[t+11]]+bt[e[t+12]]+bt[e[t+13]]+bt[e[t+14]]+bt[e[t+15]]}(r)}class wt{constructor(e=vt(),t=5e3,n="lines",r=3){this.color=e,this.numVerts=t,this.lineStyle=n,this.thickness=r,this.id=St()}}class Rt extends wt{constructor(e,t,n,r=undefined,s=undefined,i="lines",o=undefined){super(r,s,i,o),this.x=e,this.y=t,this.r=n,this.setVertices()}setVertices(){"filled"===this.lineStyle?this.vertices=function(e,t,n,r){let s=[];for(let i=0;i<r;i++){const r=e+2*n*(Math.random()-.5),i=t+2*n*(Math.random()-.5);Math.pow(r-e,2)+Math.pow(i-t,2)<n*n&&s.push(r,i)}return new Float32Array(s)}(this.x,this.y,this.r,this.numVerts):this.vertices=function(e,t,n,r){let s=new Array(r);for(let i=0;i<r;i++){let o=2*i*Math.PI/r;s.push(e+n*Math.cos(o),t+n*Math.sin(o))}return s.push(s[0],s[1]),new Float32Array(s)}(this.x,this.y,this.r,this.numVerts)}}class At extends wt{constructor(e,t=undefined,n=undefined,r=undefined){super(t,n,"lines",r),this.program=e,this.setVertices()}setVertices(){}}class Lt{constructor(e,t){var n,r,s;this.mousePos={x:0,y:0},this.defaultSettings=new Map(Object.entries({showGrid:{type:"bool",value:!1},gridSpacing:{type:"float",value:1},showModContours:{type:"bool",value:!0},showPhaseContours:{type:"bool",value:!1},polarCoords:{type:"bool",value:!1}})),this.settings=(s=this.defaultSettings,new Map(JSON.parse(JSON.stringify(Object.entries(Object.fromEntries(s.entries())))))),this.c=e,this.mousePos={x:0,y:0},this.defaultWorkspace=t,dt.set(null!==(n=t.vars)&&void 0!==n?n:[]),mt.set(null!==(r=t.shapes)&&void 0!==r?r:[]),this.compileUserCodeToGlsl(t.code,!1)}init(e){return Re(this,void 0,void 0,(function*(){const t=this.c;Te(t);const n=t.getContext("webgl2");if(!n)return void e("No WebGL2 context");if(this.gl=n,this.camera=new _e(t,{setEventListeners:!1}),!n.getExtension("EXT_color_buffer_float"))return void e("EXT_color_buffer_float not supported");let r=new Me(n,[new Ie("u_worldMat","mat3"),new Ie("u_mouse","vec2"),new Ie("u_resolution","vec2"),new Ie("u_scale","vec2")]);this.settings.forEach(((e,t)=>{r.addUniform(new Ie(`u_${t}`,e.type,e.value))})),this.mainProgram=r;let s=new Me(n,[new Ie("u_point","vec2")]);this.compProgram=s;let i=new Me(n,[new Ie("u_worldMatInv","mat3"),new Ie("u_color","vec3"),new Ie("u_t","float"),new Ie("u_scale","vec2"),new Ie("u_pointSize","float")]);if(this.shapeProgram=i,this.addUniformsFromWorkspace(this.defaultWorkspace),yield r.compileFromUrls("shaders/main/vertex.glsl","shaders/main/fragment.glsl",this.userCodeGlsl),yield s.compileFromUrls("shaders/comp-fval/vertex.glsl","shaders/comp-fval/fragment.glsl",this.userCodeGlsl),console.log(this.userCodeGlsl),yield i.compileFromUrls("shaders/shapes/vertex.glsl","shaders/shapes/fragment.glsl",this.userCodeGlsl),!(r&&s&&i))return;this.quadVao=function(e,t){let n=e.createBuffer(),r=e.createVertexArray();return e.bindBuffer(e.ARRAY_BUFFER,n),e.bindVertexArray(r),e.enableVertexAttribArray(t),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),e.STATIC_DRAW),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0),r}(n,n.getAttribLocation(r.id,"a_position")),this.shapesVao=this.createShapeVao();let o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o);let a=n.createTexture();n.bindTexture(n.TEXTURE_2D,a),n.texImage2D(n.TEXTURE_2D,0,n.RGBA32F,1,1,0,n.RGBA,n.FLOAT,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,a,0),this.compFbo=o}))}updateSetting(e,t,n=!0){if(!this.settings.has(e))throw new Error(`setting ${e} doesnt exist`);this.settings.get(e).value=t,this.mainProgram.uniforms.has(`u_${e}`)&&this.mainProgram.setUniformValue(`u_${e}`,t),n&&this.render()}getSetting(e){if(!this.settings.has(e))throw new Error(`setting ${e} doesnt exist`);return this.settings.get(e).value}addUniform(e,t=null,n="float"){this.mainProgram.addUniform(new Ie(e,n)),this.compProgram.addUniform(new Ie(e,n)),this.shapeProgram.addUniform(new Ie(e,n)),this.setUniformValue(e,t)}deleteUniform(e){this.mainProgram.deleteUniform(e),this.compProgram.deleteUniform(e),this.shapeProgram.deleteUniform(e)}setUniformValue(e,t){this.mainProgram.setUniformValue(e,t),this.compProgram.setUniformValue(e,t),this.shapeProgram.setUniformValue(e,t)}addUniformsFromWorkspace(e){e.vars.forEach((e=>{"float"===e.type&&this.addUniform(e.name,e.value,"float"),"vec2"===e.type&&this.addUniform(e.name,[e.x,e.y],"vec2")}))}loadNewWorkSpace(e){l(dt).forEach((e=>this.deleteUniform(e.name))),dt.set(e.vars),mt.set(e.shapes),this.addUniformsFromWorkspace(e),this.compileUserCodeToGlsl(e.code,!0)}recompilePrograms(){console.log(this.mainProgram.uniforms);try{this.mainProgram.recompile(this.userCodeGlsl),this.compProgram.recompile(this.userCodeGlsl),this.shapeProgram.recompile(this.userCodeGlsl)}catch(e){return void ht.set([e])}ht.set([]),this.render()}compileUserCodeToGlsl(e,t=!0){const n=function(e,t,n=!1){let r,s,i,o=[];try{r=new Qe(e).scan(),s=new Ze(r).parse();const o=new Map;for(const[e,n]of t.entries())o.set(e,{type:Ke.get(n)});let a=new at(s,o);n||a.typecheckTree(),i=new rt(s).transform()}catch(e){if(!(e instanceof ze))throw console.error("Internal compiler error"),e;o.push(e)}return{tokens:r,astTree:s,glslString:i,errors:o}}(e,new Map(l(dt).map((e=>[e.name,e.type]))));n.errors.length>0?ht.set(n.errors):(ht.set([]),this.userCodeGlsl=n.glslString,t&&this.recompilePrograms())}computeFval(e){const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.compFbo),t.useProgram(this.compProgram.id),this.compProgram.setUniformValue("u_point",[e.x,e.y]),this.compProgram.bindAllUniforms(),t.viewport(0,0,this.c.width,this.c.height),t.clearColor(1,1,1,1),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.POINTS,0,1);let n=new Float32Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.FLOAT,n),t.bindFramebuffer(t.FRAMEBUFFER,null),{x:n[0],y:n[1]}}createShapeVao(){const e=this.gl;let t=e.getAttribLocation(this.shapeProgram.id,"a_position"),n=e.createBuffer(),r=e.createVertexArray();return e.bindVertexArray(r),e.enableVertexAttribArray(t),e.bindBuffer(e.ARRAY_BUFFER,n),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0),r}renderShape(e){const t=this.gl;t.useProgram(this.shapeProgram.id);let n=e.color.substring(1).match(/.{2}/g).map((e=>parseInt(e,16)/255));this.shapeProgram.setUniformValue("u_color",n),this.shapeProgram.setUniformValue("u_worldMatInv",this.camera.getInverseWorldMatrix()),this.shapeProgram.setUniformValue("u_scale",[this.camera.scale.x,this.camera.scale.y]),this.shapeProgram.setUniformValue("u_pointSize",Math.max(1,e.thickness)),this.shapeProgram.bindAllUniforms();const r=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE)[1];let s=t.LINE_STRIP;"points"===e.lineStyle?s=t.POINTS:"lines"===e.lineStyle?(s=t.LINE_STRIP,t.lineWidth(Math.min(e.thickness,r))):"filled"===e.lineStyle&&(e instanceof Rt?s=t.POINTS:(e.vertices=new Float32Array([e.vertices[0],e.vertices[1],...e.vertices]),s=t.TRIANGLE_FAN)),t.bufferData(t.ARRAY_BUFFER,e.vertices,t.STATIC_DRAW),t.drawArrays(s,0,e.vertices.length/2)}doRender(e=!0){const t=this.gl;t.viewport(0,0,this.c.width,this.c.height),t.clearColor(.42,.42,1,1),t.clear(t.COLOR_BUFFER_BIT),t.bindFramebuffer(t.FRAMEBUFFER,null),t.useProgram(this.mainProgram.id),this.mainProgram.setUniformValue("u_worldMat",this.camera.getWorldMatrix()),this.mainProgram.setUniformValue("u_mouse",[this.mousePos.x,this.mousePos.y]),this.mainProgram.setUniformValue("u_resolution",[this.c.width,this.c.height]),this.mainProgram.setUniformValue("u_scale",[this.camera.scale.x,this.camera.scale.y]),this.mainProgram.bindAllUniforms(),t.bindVertexArray(this.quadVao),t.drawArrays(t.TRIANGLES,0,6),t.bindVertexArray(this.shapesVao);for(let e of l(mt))this.renderShape(e);e||requestAnimationFrame((()=>this.doRender(e)))}render(){requestAnimationFrame((()=>this.doRender(!0)))}}function _t(t){let n,r,s,i,o,a,l,c,u=t[2](t[0])+"",h=t[2](t[1])+"";return{c(){n=w("div"),r=w("p"),s=R("   z = "),i=R(u),o=A(),a=w("p"),l=R("f(z) = "),c=R(h),k(r,"class","svelte-7mx576"),k(a,"class","svelte-7mx576"),k(n,"id","coordinate-box"),k(n,"class","svelte-7mx576")},m(e,t){b(e,n,t),y(n,r),y(r,s),y(r,i),y(n,o),y(n,a),y(a,l),y(a,c)},p(e,[t]){1&t&&u!==(u=e[2](e[0])+"")&&U(i,u),2&t&&h!==(h=e[2](e[1])+"")&&U(c,h)},i:e,o:e,d(e){e&&$(n)}}}function kt(e){return Math.abs(e)<.001||Math.abs(e)>=1e3?e.toExponential(3):e.toFixed(3)}function Tt(e,t,n){let{mouse:r}=t,{fval:s}=t,{canvas:i}=t;return e.$$set=e=>{"mouse"in e&&n(0,r=e.mouse),"fval"in e&&n(1,s=e.fval),"canvas"in e&&n(3,i=e.canvas)},[r,s,function(e){if(i.getSetting("polarCoords")){let{r:r,theta:s}=(t=e.x,n=e.y,{r:Math.sqrt(t*t+n*n),theta:Math.atan2(n,t)});return`${kt(r)} ∠ ${kt(s/Math.PI)} π`}return e.y<0?`${kt(e.x)} - ${kt(-e.y)}i`:`${kt(e.x)} + ${kt(e.y)}i`;var t,n},i]}class Ut extends we{constructor(e){super(),Se(this,e,Tt,_t,o,{mouse:0,fval:1,canvas:3})}}function It(e,t,n){const r=e.slice();return r[3]=t[n],r}function Nt(e){let t,n,r,s,i,o=e[3].name+"";function a(){return e[2](e[3])}return{c(){t=w("button"),n=R(o),r=A(),k(t,"class","tab svelte-o94sru"),C(t,"active",e[3].id==e[0].id)},m(e,o){b(e,t,o),y(t,n),y(t,r),s||(i=_(t,"click",a),s=!0)},p(r,s){e=r,2&s&&o!==(o=e[3].name+"")&&U(n,o),3&s&&C(t,"active",e[3].id==e[0].id)},d(e){e&&$(t),s=!1,i()}}}function Ot(t){let n,r=t[1],s=[];for(let e=0;e<r.length;e+=1)s[e]=Nt(It(t,r,e));return{c(){n=w("div");for(let e=0;e<s.length;e+=1)s[e].c();k(n,"id","navbar"),k(n,"class","svelte-o94sru")},m(e,t){b(e,n,t);for(let e=0;e<s.length;e+=1)s[e].m(n,null)},p(e,[t]){if(3&t){let i;for(r=e[1],i=0;i<r.length;i+=1){const o=It(e,r,i);s[i]?s[i].p(o,t):(s[i]=Nt(o),s[i].c(),s[i].m(n,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=r.length}},i:e,o:e,d(e){e&&$(n),S(s,e)}}}function Ct(e,t,n){let{tabs:r}=t,{activeTab:s}=t;return e.$$set=e=>{"tabs"in e&&n(1,r=e.tabs),"activeTab"in e&&n(0,s=e.activeTab)},[s,r,e=>n(0,s=e)]}class Ft extends we{constructor(e){super(),Se(this,e,Ct,Ot,o,{tabs:1,activeTab:0})}}const Mt={identity:"f(z) := z",exp:"f(z) := e^z",juliaSetStandard:"g(z) := z^2 + c\n\nf(z) := \n  for j = 1..N: z = g(z)\n  return z",juliaSetBurningShip:"g(z) := (abs(re(z)) + i abs(im(z)))^x + c\n\nf(z) := \n  for j = 1..N: z = g(z)\n  return z",mandelbrotStandard:"g(z, c) := z^x + c\n\nf(c) := \n  w := 0 + 0i\n  for j = 1..N: \n    if abs(w) > 2: break\n    w = g(w, c)\n  return w"};function Pt(e,t,n=-10,r=10,s=.001){return{id:St(),type:"float",name:e,value:t,min:n,max:r,step:s}}function Bt(e,t=0,n=0,r=vt()){return{id:St(),type:"vec2",name:e,x:t,y:n,color:r}}const Dt={identity:{code:Mt.identity,vars:[],shapes:[new Rt(0,0,1)]},exp:{code:Mt.exp,vars:[],shapes:[new Rt(0,0,1)]},juliaSetStandard:{code:Mt.juliaSetStandard,vars:[Pt("N",50,0,100,1),Bt("c",.272,.575)],shapes:[]},juliaSetBurningShip1:{code:Mt.juliaSetBurningShip,vars:[Pt("N",100,0,100,1),Bt("c",-.128,-.847),Pt("x",2)],shapes:[]},juliaSetBurningShip2:{code:Mt.juliaSetBurningShip,vars:[Pt("N",100,0,100,1),Bt("c",-.371,.412),Pt("x",-1.46939)],shapes:[]},mandelbrotStandard:{code:Mt.mandelbrotStandard,vars:[Pt("N",100,0,100,1),Pt("x",2)],shapes:[]}},zt="identity";function Vt(e){const t=e-1;return t*t*t+1}function jt(e,{delay:n=0,duration:r=400,easing:s=t}={}){const i=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:s,css:e=>"opacity: "+e*i}}function Gt(e,{delay:t=0,duration:n=400,easing:r=Vt,x:s=0,y:i=0,opacity:o=0}={}){const a=getComputedStyle(e),l=+a.opacity,c="none"===a.transform?"":a.transform,u=l*(1-o);return{delay:t,duration:n,easing:r,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*s}px, ${(1-e)*i}px);\n\t\t\topacity: ${l-u*t}`}}function Wt(e,{delay:t=0,duration:n=400,easing:r=Vt}={}){const s=getComputedStyle(e),i=+s.opacity,o=parseFloat(s.height),a=parseFloat(s.paddingTop),l=parseFloat(s.paddingBottom),c=parseFloat(s.marginTop),u=parseFloat(s.marginBottom),h=parseFloat(s.borderTopWidth),d=parseFloat(s.borderBottomWidth);return{delay:t,duration:n,easing:r,css:e=>`overflow: hidden;opacity: ${Math.min(20*e,1)*i};height: ${e*o}px;padding-top: ${e*a}px;padding-bottom: ${e*l}px;margin-top: ${e*c}px;margin-bottom: ${e*u}px;border-top-width: ${e*h}px;border-bottom-width: ${e*d}px;`}}function qt(e,t,n){const r=e.slice();return r[19]=t[n],r[21]=n,r}function Qt(e,t,n){const r=e.slice();return r[22]=t[n][0],r[23]=t[n][1],r}function Ht(e){let t,n,r,s=Object.entries(Dt),i=[];for(let t=0;t<s.length;t+=1)i[t]=Yt(Qt(e,s,t));return{c(){t=w("div");for(let e=0;e<i.length;e+=1)i[e].c();k(t,"id","examples-container"),k(t,"class","svelte-gg5y57")},m(e,n){b(e,t,n);for(let e=0;e<i.length;e+=1)i[e].m(t,null);r=!0},p(e,n){if(272&n){let r;for(s=Object.entries(Dt),r=0;r<s.length;r+=1){const o=Qt(e,s,r);i[r]?i[r].p(o,n):(i[r]=Yt(o),i[r].c(),i[r].m(t,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=s.length}},i(e){r||(Z((()=>{n||(n=fe(t,jt,{duration:100},!0)),n.run(1)})),r=!0)},o(e){n||(n=fe(t,jt,{duration:100},!1)),n.run(0),r=!1},d(e){e&&$(t),S(i,e),e&&n&&n.end()}}}function Yt(e){let t,n,r,s,i=e[22]+"";function o(){return e[15](e[22],e[23])}return{c(){t=w("button"),n=R(i),k(t,"class","svelte-gg5y57"),C(t,"selected",e[22]===e[4])},m(e,i){b(e,t,i),y(t,n),r||(s=_(t,"click",o),r=!0)},p(n,r){e=n,16&r&&C(t,"selected",e[22]===e[4])},d(e){e&&$(t),r=!1,s()}}}function Xt(e){let t,n=e[6],r=[];for(let t=0;t<n.length;t+=1)r[t]=Kt(qt(e,n,t));return{c(){t=w("div");for(let e=0;e<r.length;e+=1)r[e].c();k(t,"id","error-div"),k(t,"class","svelte-gg5y57")},m(e,n){b(e,t,n);for(let e=0;e<r.length;e+=1)r[e].m(t,null)},p(e,s){if(64&s){let i;for(n=e[6],i=0;i<n.length;i+=1){const o=qt(e,n,i);r[i]?r[i].p(o,s):(r[i]=Kt(o),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){e&&$(t),S(r,e)}}}function Kt(e){let t,n,r=e[19].toString()+"";return{c(){t=w("p"),n=R(r),k(t,"class","svelte-gg5y57")},m(e,r){b(e,t,r),y(t,n)},p(e,t){64&t&&r!==(r=e[19].toString()+"")&&U(n,r)},d(e){e&&$(t)}}}function Jt(e){let t,n,r,s;return{c(){t=w("span"),t.textContent="Transpiled glsl:",n=A(),r=w("pre"),s=R(e[2]),N(t,"color","var(--c-white)"),k(r,"id","glsl-output"),k(r,"class","svelte-gg5y57")},m(e,i){b(e,t,i),b(e,n,i),b(e,r,i),y(r,s)},p(e,t){4&t&&U(s,e[2])},d(e){e&&$(t),e&&$(n),e&&$(r)}}}function Zt(e){let t,n,r,i,o,a,l,c,u,h,d,m,p,f,g,v,x,E=e[5]&&Ht(e),S=e[6].length>0&&Xt(e),T=e[3]&&Jt(e);return{c(){t=w("div"),n=w("button"),n.textContent="Show glsl",r=A(),i=w("button"),i.textContent="Reset",o=A(),a=w("div"),l=w("button"),l.textContent="Examples",c=A(),E&&E.c(),u=A(),h=w("pre"),d=R(e[0]),m=A(),S&&S.c(),p=A(),T&&T.c(),f=L(),k(n,"class","svelte-gg5y57"),C(n,"selected",e[3]),k(i,"class","svelte-gg5y57"),k(l,"class","svelte-gg5y57"),C(l,"selected",e[5]),k(a,"id","tooltip-container"),k(a,"class","svelte-gg5y57"),k(t,"id","buttons-div"),k(t,"class","svelte-gg5y57"),k(h,"id","editor"),k(h,"contenteditable","true"),k(h,"class","svelte-gg5y57"),C(h,"error",e[6].length>0)},m(s,$){b(s,t,$),y(t,n),y(t,r),y(t,i),y(t,o),y(t,a),y(a,l),y(a,c),E&&E.m(a,null),b(s,u,$),b(s,h,$),y(h,d),e[17](h),b(s,m,$),S&&S.m(s,$),b(s,p,$),T&&T.m(s,$),b(s,f,$),g=!0,v||(x=[_(n,"click",e[12]),_(i,"click",e[13]),_(l,"click",e[14]),_(a,"focusout",e[16]),_(h,"input",e[9]),_(h,"keydown",e[10])],v=!0)},p(e,[t]){(!g||8&t)&&C(n,"selected",e[3]),(!g||32&t)&&C(l,"selected",e[5]),e[5]?E?(E.p(e,t),32&t&&de(E,1)):(E=Ht(e),E.c(),de(E,1),E.m(a,null)):E&&(ue(),me(E,1,1,(()=>{E=null})),he()),(!g||1&t)&&U(d,e[0]),(!g||64&t)&&C(h,"error",e[6].length>0),e[6].length>0?S?S.p(e,t):(S=Xt(e),S.c(),S.m(p.parentNode,p)):S&&(S.d(1),S=null),e[3]?T?T.p(e,t):(T=Jt(e),T.c(),T.m(f.parentNode,f)):T&&(T.d(1),T=null)},i(e){g||(de(E),g=!0)},o(e){me(E),g=!1},d(n){n&&$(t),E&&E.d(),n&&$(u),n&&$(h),e[17](null),n&&$(m),S&&S.d(n),n&&$(p),T&&T.d(n),n&&$(f),v=!1,s(x)}}}const en=4;function tn(e,t,n){let r;c(e,ht,(e=>n(6,r=e)));let s,{canvas:i}=t,{code:o}=t,a=i.userCodeGlsl,l=!1,u=zt;const h=o;let d=!1;function m(e,t){n(4,u=e),n(0,o=t.code),i.loadNewWorkSpace(t)}return e.$$set=e=>{"canvas"in e&&n(11,i=e.canvas),"code"in e&&n(0,o=e.code)},[o,s,a,l,u,d,r,h,m,function(e){n(0,o=e.target.innerText),i.compileUserCodeToGlsl(o,!0),n(2,a=i.userCodeGlsl),r.forEach((e=>console.error(e.toString())))},function(e){"Tab"===e.key&&(e.preventDefault(),function(){let e=window.getSelection();e.getRangeAt(0).startOffset;let t=e.focusNode,r=e.focusOffset,i=document.createRange();i.selectNode(t),i.setStart(t,r+en),i.collapse(!0),e.removeAllRanges(),e.addRange(i),n(0,o=s.innerText)}())},i,()=>n(3,l=!l),()=>n(0,o=h),()=>n(5,d=!d),(e,t)=>m(e,t),e=>ft(e,(()=>n(5,d=!1))),function(e){H[e?"unshift":"push"]((()=>{s=e,n(1,s)}))}]}class nn extends we{constructor(e){super(),Se(this,e,tn,Zt,o,{canvas:11,code:0})}}function rn(e){let t,n,r;return{c(){t=w("input"),k(t,"type","number"),k(t,"step",e[3]),k(t,"min",e[4]),k(t,"max",e[5]),k(t,"class","svelte-14hpse")},m(s,i){b(s,t,i),e[10](t),I(t,e[0]),n||(r=[_(t,"input",e[11]),_(t,"input",e[7])],n=!0)},p(e,n){8&n&&k(t,"step",e[3]),16&n&&k(t,"min",e[4]),32&n&&k(t,"max",e[5]),1&n&&T(t.value)!==e[0]&&I(t,e[0])},d(i){i&&$(t),e[10](null),n=!1,s(r)}}}function sn(e){let t,n,r;return{c(){t=w("input"),k(t,"type","text"),k(t,"class","svelte-14hpse")},m(s,i){b(s,t,i),I(t,e[0]),e[9](t),n||(r=[_(t,"input",e[8]),_(t,"input",e[6])],n=!0)},p(e,n){1&n&&t.value!==e[0]&&I(t,e[0])},d(i){i&&$(t),e[9](null),n=!1,s(r)}}}function on(t){let n,r,s,i;function o(e,t){return"text"===e[2]?sn:"number"===e[2]?rn:void 0}let a=o(t),l=a&&a(t);return{c(){n=w("div"),r=w("span"),s=R(t[0]),i=A(),l&&l.c(),k(r,"class","svelte-14hpse"),k(n,"id","container"),k(n,"class","svelte-14hpse")},m(e,t){b(e,n,t),y(n,r),y(r,s),y(n,i),l&&l.m(n,null)},p(e,[t]){1&t&&U(s,e[0]),a===(a=o(e))&&l?l.p(e,t):(l&&l.d(1),l=a&&a(e),l&&(l.c(),l.m(n,null)))},i:e,o:e,d(e){e&&$(n),l&&l.d()}}}function an(e,t,n){let{type:r}=t,{value:s}=t,{step:i=.001}=t,{min:o=-1/0}=t,{max:a=1/0}=t,{inputElem:l=null}=t;return e.$$set=e=>{"type"in e&&n(2,r=e.type),"value"in e&&n(0,s=e.value),"step"in e&&n(3,i=e.step),"min"in e&&n(4,o=e.min),"max"in e&&n(5,a=e.max),"inputElem"in e&&n(1,l=e.inputElem)},[s,l,r,i,o,a,function(t){q.call(this,e,t)},function(t){q.call(this,e,t)},function(){s=this.value,n(0,s)},function(e){H[e?"unshift":"push"]((()=>{l=e,n(1,l)}))},function(e){H[e?"unshift":"push"]((()=>{l=e,n(1,l)}))},function(){s=T(this.value),n(0,s)}]}class ln extends we{constructor(e){super(),Se(this,e,an,on,o,{type:2,value:0,step:3,min:4,max:5,inputElem:1})}}function cn(e){let t,n,r;return{c(){t=w("input"),k(t,"type","color"),k(t,"id","color-picker"),k(t,"class","svelte-1mte4q2"),N(t,"background-color",e[0].color)},m(s,i){b(s,t,i),I(t,e[0].color),n||(r=[_(t,"input",e[10]),_(t,"input",e[9])],n=!0)},p(e,n){1&n&&I(t,e[0].color),1&n&&N(t,"background-color",e[0].color)},d(e){e&&$(t),n=!1,s(r)}}}function un(e){let t,n,r,s,i,o,a,l;return t=new ln({props:{type:"number",value:e[3],step:.001}}),t.$on("input",e[14]),i=new ln({props:{type:"number",value:e[4],step:.001}}),i.$on("input",e[15]),{c(){xe(t.$$.fragment),n=A(),r=w("span"),r.textContent="+",s=A(),xe(i.$$.fragment),o=A(),a=w("span"),a.textContent="i",k(r,"class","non-clickable svelte-1mte4q2"),k(a,"class","non-clickable letter-i svelte-1mte4q2")},m(e,c){Ee(t,e,c),b(e,n,c),b(e,r,c),b(e,s,c),Ee(i,e,c),b(e,o,c),b(e,a,c),l=!0},p(e,n){const r={};8&n&&(r.value=e[3]),t.$set(r);const s={};16&n&&(s.value=e[4]),i.$set(s)},i(e){l||(de(t.$$.fragment,e),de(i.$$.fragment,e),l=!0)},o(e){me(t.$$.fragment,e),me(i.$$.fragment,e),l=!1},d(e){be(t,e),e&&$(n),e&&$(r),e&&$(s),be(i,e),e&&$(o),e&&$(a)}}}function hn(t){let n,r,i,o,a,l;return{c(){n=w("input"),k(n,"id","value-input"),k(n,"type","number"),k(n,"min",r=t[0].min),k(n,"max",i=t[0].max),k(n,"step",o=t[0].step),k(n,"class","svelte-1mte4q2")},m(e,r){b(e,n,r),I(n,t[0].value),a||(l=[_(n,"input",t[13]),_(n,"input",t[9])],a=!0)},p(e,t){1&t&&r!==(r=e[0].min)&&k(n,"min",r),1&t&&i!==(i=e[0].max)&&k(n,"max",i),1&t&&o!==(o=e[0].step)&&k(n,"step",o),1&t&&T(n.value)!==e[0].value&&I(n,e[0].value)},i:e,o:e,d(e){e&&$(n),a=!1,s(l)}}}function dn(e){let t,n,r,i,o,a,l,c,u,h,d,m,p,f=e[0].min+"",g=e[0].max+"";return{c(){t=w("div"),n=w("span"),r=R(f),i=A(),o=w("input"),u=A(),h=w("span"),d=R(g),k(o,"id","slider"),k(o,"type","range"),k(o,"min",a=e[0].min),k(o,"max",l=e[0].max),k(o,"step",c=e[0].step),k(o,"class","svelte-1mte4q2"),k(t,"id","row2"),k(t,"class","svelte-1mte4q2")},m(s,a){b(s,t,a),y(t,n),y(n,r),y(t,i),y(t,o),I(o,e[0].value),y(t,u),y(t,h),y(h,d),m||(p=[_(o,"change",e[21]),_(o,"input",e[21]),_(o,"input",e[9])],m=!0)},p(e,t){1&t&&f!==(f=e[0].min+"")&&U(r,f),1&t&&a!==(a=e[0].min)&&k(o,"min",a),1&t&&l!==(l=e[0].max)&&k(o,"max",l),1&t&&c!==(c=e[0].step)&&k(o,"step",c),1&t&&I(o,e[0].value),1&t&&g!==(g=e[0].max+"")&&U(d,g)},d(e){e&&$(t),m=!1,s(p)}}}function mn(e){let t;function n(e,t){return"float"===e[0].type?fn:pn}let r=n(e),s=r(e);return{c(){t=w("div"),s.c(),k(t,"id","edit-ui"),k(t,"class","svelte-1mte4q2")},m(e,n){b(e,t,n),s.m(t,null)},p(e,i){r===(r=n(e))&&s?s.p(e,i):(s.d(1),s=r(e),s&&(s.c(),s.m(t,null)))},d(e){e&&$(t),s.d()}}}function pn(t){let n,r,s;return{c(){n=w("button"),n.textContent="Reset",k(n,"id","reset-point-btn"),k(n,"class","svelte-1mte4q2")},m(e,i){b(e,n,i),r||(s=_(n,"click",t[6]),r=!0)},p:e,d(e){e&&$(n),r=!1,s()}}}function fn(e){let t,n,r,i,o,a,l,c,u,h;return{c(){t=w("span"),t.textContent="Min: ",n=w("input"),r=A(),i=w("span"),i.textContent="Max: ",o=w("input"),a=A(),l=w("span"),l.textContent="Step: ",c=w("input"),k(n,"type","number"),k(n,"class","svelte-1mte4q2"),k(o,"type","number"),k(o,"class","svelte-1mte4q2"),k(c,"type","number"),k(c,"class","svelte-1mte4q2")},m(s,d){b(s,t,d),b(s,n,d),I(n,e[0].min),b(s,r,d),b(s,i,d),b(s,o,d),I(o,e[0].max),b(s,a,d),b(s,l,d),b(s,c,d),I(c,e[0].step),u||(h=[_(n,"input",e[18]),_(o,"input",e[19]),_(c,"input",e[20])],u=!0)},p(e,t){1&t&&T(n.value)!==e[0].min&&I(n,e[0].min),1&t&&T(o.value)!==e[0].max&&I(o,e[0].max),1&t&&T(c.value)!==e[0].step&&I(c,e[0].step)},d(e){e&&$(t),e&&$(n),e&&$(r),e&&$(i),e&&$(o),e&&$(a),e&&$(l),e&&$(c),u=!1,s(h)}}}function gn(e){let t,n,r,i,o,a,l,c,u,h,d,m,p,f,g,v,x,E,S,R,L="vec2"===e[0].type&&cn(e);function T(t){e[11](t)}function U(t){e[12](t)}let I={type:"text"};void 0!==e[0].name&&(I.value=e[0].name),void 0!==e[2]&&(I.inputElem=e[2]),i=new ln({props:I}),H.push((()=>ye(i,"value",T))),H.push((()=>ye(i,"inputElem",U))),i.$on("input",e[7]);const N=[hn,un],O=[];function F(e,t){return"float"===e[0].type?0:"vec2"===e[0].type?1:-1}function M(e,t){return e[1]?mn:"float"===e[0].type?dn:void 0}~(h=F(e))&&(d=O[h]=N[h](e));let P=M(e),B=P&&P(e);return{c(){t=w("div"),n=w("div"),L&&L.c(),r=A(),xe(i.$$.fragment),l=A(),c=w("span"),c.textContent="=",u=A(),d&&d.c(),m=A(),p=w("button"),f=w("i"),g=A(),v=w("button"),v.innerHTML='<i class="bi bi-x-circle svelte-1mte4q2"></i>',x=A(),B&&B.c(),k(c,"class","non-clickable svelte-1mte4q2"),k(f,"class","bi bi-gear svelte-1mte4q2"),C(f,"active",e[1]),k(p,"id","settings-btn"),k(p,"class","svelte-1mte4q2"),k(v,"class","svelte-1mte4q2"),k(n,"id","row1"),k(n,"class","svelte-1mte4q2"),k(t,"id","container"),k(t,"class","svelte-1mte4q2")},m(s,o){b(s,t,o),y(t,n),L&&L.m(n,null),y(n,r),Ee(i,n,null),y(n,l),y(n,c),y(n,u),~h&&O[h].m(n,null),y(n,m),y(n,p),y(p,f),y(n,g),y(n,v),y(t,x),B&&B.m(t,null),E=!0,S||(R=[_(p,"click",e[16]),_(v,"click",e[17]),_(t,"keydown",e[22])],S=!0)},p(e,[s]){"vec2"===e[0].type?L?L.p(e,s):(L=cn(e),L.c(),L.m(n,r)):L&&(L.d(1),L=null);const l={};!o&&1&s&&(o=!0,l.value=e[0].name,ee((()=>o=!1))),!a&&4&s&&(a=!0,l.inputElem=e[2],ee((()=>a=!1))),i.$set(l);let c=h;h=F(e),h===c?~h&&O[h].p(e,s):(d&&(ue(),me(O[c],1,1,(()=>{O[c]=null})),he()),~h?(d=O[h],d?d.p(e,s):(d=O[h]=N[h](e),d.c()),de(d,1),d.m(n,m)):d=null),(!E||2&s)&&C(f,"active",e[1]),P===(P=M(e))&&B?B.p(e,s):(B&&B.d(1),B=P&&P(e),B&&(B.c(),B.m(t,null)))},i(e){E||(de(i.$$.fragment,e),de(d),E=!0)},o(e){me(i.$$.fragment,e),me(d),E=!1},d(e){e&&$(t),L&&L.d(),be(i),~h&&O[h].d(),B&&B.d(),S=!1,s(R)}}}function vn(e,t,n){let r,s,i,{data:o}=t,a=W(),l=!1,c=o.name;function u(e,t){"vec2"===o.type&&("x"===e&&n(0,o.x=t.target.value,o),"y"===e&&n(0,o.y=t.target.value,o),h())}function h(){a("valueChange",o),"float"===o.type&&(n(0,o.min=Math.min(o.min,o.value),o),n(0,o.max=Math.max(o.max,o.value),o))}G((()=>{r.focus()}));return e.$$set=e=>{"data"in e&&n(0,o=e.data)},e.$$.update=()=>{1&e.$$.dirty&&"vec2"===o.type&&(n(3,s=gt(o.x,3)),n(4,i=gt(o.y,3)))},[o,l,r,s,i,a,function(){"vec2"===o.type&&(n(0,o.x=0,o),n(0,o.y=0,o)),h(),n(1,l=!1)},function(){a("nameChange",{prevName:c,data:o}),c=o.name},u,h,function(){o.color=this.value,n(0,o)},function(t){e.$$.not_equal(o.name,t)&&(o.name=t,n(0,o))},function(e){r=e,n(2,r)},function(){o.value=T(this.value),n(0,o)},e=>u("x",e),e=>u("y",e),()=>n(1,l=!l),()=>a("delete",o),function(){o.min=T(this.value),n(0,o)},function(){o.max=T(this.value),n(0,o)},function(){o.step=T(this.value),n(0,o)},function(){o.value=T(this.value),n(0,o)},e=>{"Enter"===e.key&&n(1,l=!1)}]}class yn extends we{constructor(e){super(),Se(this,e,vn,gn,o,{data:0})}}function xn(t){let n,r,i,o,a,l,c,u,h,d,m,p,f,g,v,x,E,S,R,L,T,U,I,N,O,C,F,M,P,B,D,z,V,j,G;return{c(){n=w("div"),r=w("div"),i=w("span"),i.textContent="Grid on:",o=A(),a=w("input"),c=A(),u=w("div"),h=w("span"),h.textContent="Grid spacing:",d=A(),m=w("input"),f=A(),g=w("div"),v=w("span"),v.textContent="Mod contours:",x=A(),E=w("input"),R=A(),L=w("div"),T=w("span"),T.textContent="Phase contours:",U=A(),I=w("input"),O=A(),C=w("div"),F=w("span"),F.textContent="Polar form:",M=A(),P=w("input"),D=A(),z=w("div"),V=w("button"),V.textContent="Reset camera (h)",k(i,"class","label svelte-1jasimh"),k(a,"type","checkbox"),a.checked=l=t[0].getSetting("showGrid"),k(a,"class","svelte-1jasimh"),k(r,"class","setting svelte-1jasimh"),k(h,"class","label svelte-1jasimh"),k(m,"type","range"),k(m,"min","0.05"),k(m,"max","2.0"),k(m,"step","0.001"),m.value=p=t[0].getSetting("gridSpacing"),k(m,"class","svelte-1jasimh"),k(u,"class","setting svelte-1jasimh"),k(v,"class","label svelte-1jasimh"),k(E,"type","checkbox"),E.checked=S=t[0].getSetting("showModContours"),k(E,"class","svelte-1jasimh"),k(g,"class","setting svelte-1jasimh"),k(T,"class","label svelte-1jasimh"),k(I,"type","checkbox"),I.checked=N=t[0].getSetting("showPhaseContours"),k(I,"class","svelte-1jasimh"),k(L,"class","setting svelte-1jasimh"),k(F,"class","label svelte-1jasimh"),k(P,"type","checkbox"),P.checked=B=t[0].getSetting("polarCoords"),k(P,"class","svelte-1jasimh"),k(C,"class","setting svelte-1jasimh"),k(V,"class","svelte-1jasimh"),k(z,"id","buttons"),k(z,"class","svelte-1jasimh"),k(n,"id","container"),k(n,"class","svelte-1jasimh")},m(e,s){b(e,n,s),y(n,r),y(r,i),y(r,o),y(r,a),y(n,c),y(n,u),y(u,h),y(u,d),y(u,m),y(n,f),y(n,g),y(g,v),y(g,x),y(g,E),y(n,R),y(n,L),y(L,T),y(L,U),y(L,I),y(n,O),y(n,C),y(C,F),y(C,M),y(C,P),y(n,D),y(n,z),y(z,V),j||(G=[_(a,"change",t[2]),_(m,"input",t[3]),_(E,"change",t[4]),_(I,"change",t[5]),_(P,"change",t[6]),_(V,"click",t[7])],j=!0)},p(e,[t]){1&t&&l!==(l=e[0].getSetting("showGrid"))&&(a.checked=l),1&t&&p!==(p=e[0].getSetting("gridSpacing"))&&(m.value=p),1&t&&S!==(S=e[0].getSetting("showModContours"))&&(E.checked=S),1&t&&N!==(N=e[0].getSetting("showPhaseContours"))&&(I.checked=N),1&t&&B!==(B=e[0].getSetting("polarCoords"))&&(P.checked=B)},i:e,o:e,d(e){e&&$(n),j=!1,s(G)}}}function En(e,t,n){let{canvas:r}=t,s=r.settings;return e.$$set=e=>{"canvas"in e&&n(0,r=e.canvas)},[r,s,e=>r.updateSetting("showGrid",e.target.checked),e=>r.updateSetting("gridSpacing",e.target.value),e=>r.updateSetting("showModContours",e.target.checked),e=>r.updateSetting("showPhaseContours",e.target.checked),e=>r.updateSetting("polarCoords",e.target.checked),()=>r.camera.reset()]}class bn extends we{constructor(e){super(),Se(this,e,En,xn,o,{canvas:0})}}function $n(t){let n;return{c(){n=w("div"),n.textContent="Not supported"},m(e,t){b(e,n,t)},p:e,i:e,o:e,d(e){e&&$(n)}}}function Sn(e){let t,n,r,s,i,o,a,l,c,u,h,d,m,p,f,g,v,x;function E(t){e[9](t)}let S={type:"number",step:.1};function R(t){e[10](t)}void 0!==e[0].x&&(S.value=e[0].x),s=new ln({props:S}),H.push((()=>ye(s,"value",E))),s.$on("input",e[3]);let L={type:"number",step:.1};function _(t){e[11](t)}void 0!==e[0].y&&(L.value=e[0].y),u=new ln({props:L}),H.push((()=>ye(u,"value",R))),u.$on("input",e[3]);let T={type:"number",step:.1,min:0};return void 0!==e[0].r&&(T.value=e[0].r),g=new ln({props:T}),H.push((()=>ye(g,"value",_))),g.$on("input",e[3]),{c(){t=w("div"),n=w("p"),n.textContent="x:",r=A(),xe(s.$$.fragment),o=A(),a=w("div"),l=w("p"),l.textContent="y:",c=A(),xe(u.$$.fragment),d=A(),m=w("div"),p=w("p"),p.textContent="r:",f=A(),xe(g.$$.fragment),k(n,"class","svelte-1i1di7x"),k(t,"class","param svelte-1i1di7x"),k(l,"class","svelte-1i1di7x"),k(a,"class","param svelte-1i1di7x"),k(p,"class","svelte-1i1di7x"),k(m,"class","param svelte-1i1di7x")},m(e,i){b(e,t,i),y(t,n),y(t,r),Ee(s,t,null),b(e,o,i),b(e,a,i),y(a,l),y(a,c),Ee(u,a,null),b(e,d,i),b(e,m,i),y(m,p),y(m,f),Ee(g,m,null),x=!0},p(e,t){const n={};!i&&1&t&&(i=!0,n.value=e[0].x,ee((()=>i=!1))),s.$set(n);const r={};!h&&1&t&&(h=!0,r.value=e[0].y,ee((()=>h=!1))),u.$set(r);const o={};!v&&1&t&&(v=!0,o.value=e[0].r,ee((()=>v=!1))),g.$set(o)},i(e){x||(de(s.$$.fragment,e),de(u.$$.fragment,e),de(g.$$.fragment,e),x=!0)},o(e){me(s.$$.fragment,e),me(u.$$.fragment,e),me(g.$$.fragment,e),x=!1},d(e){e&&$(t),be(s),e&&$(o),e&&$(a),be(u),e&&$(d),e&&$(m),be(g)}}}function wn(e){let t,n,r,i,o,a,l,c,u,h,d,m,p,f,g,v,x,E,S,L,T,I,N,C,F="lines"===e[0].lineStyle?"Line width:":"Point size:";function M(t){e[6](t)}let P={type:"number",step:100,min:5};function B(t){e[7](t)}void 0!==e[0].numVerts&&(P.value=e[0].numVerts),o=new ln({props:P}),H.push((()=>ye(o,"value",M))),o.$on("input",e[3]);let D={type:"number",step:1,min:1,max:50};return void 0!==e[0].thickness&&(D.value=e[0].thickness),m=new ln({props:D}),H.push((()=>ye(m,"value",B))),m.$on("input",e[3]),{c(){t=w("div"),n=w("div"),r=w("p"),r.textContent="Number of vertices:",i=A(),xe(o.$$.fragment),l=A(),c=w("div"),u=w("p"),h=R(F),d=A(),xe(m.$$.fragment),f=A(),g=w("div"),v=w("p"),v.textContent="Draw style:",x=A(),E=w("select"),S=w("option"),S.textContent="Lines",L=w("option"),L.textContent="Points",T=w("option"),T.textContent="Filled",k(r,"class","svelte-1i1di7x"),k(n,"class","param svelte-1i1di7x"),k(u,"class","svelte-1i1di7x"),k(c,"class","param svelte-1i1di7x"),k(v,"class","svelte-1i1di7x"),S.__value="lines",S.value=S.__value,L.__value="points",L.value=L.__value,T.__value="filled",T.value=T.__value,k(E,"class","svelte-1i1di7x"),void 0===e[0].lineStyle&&Z((()=>e[8].call(E))),k(g,"class","param svelte-1i1di7x"),k(t,"class","edit-ui-container svelte-1i1di7x")},m(s,a){b(s,t,a),y(t,n),y(n,r),y(n,i),Ee(o,n,null),y(t,l),y(t,c),y(c,u),y(u,h),y(c,d),Ee(m,c,null),y(t,f),y(t,g),y(g,v),y(g,x),y(g,E),y(E,S),y(E,L),y(E,T),O(E,e[0].lineStyle),I=!0,N||(C=[_(E,"change",e[8]),_(E,"change",e[3])],N=!0)},p(e,t){const n={};!a&&1&t&&(a=!0,n.value=e[0].numVerts,ee((()=>a=!1))),o.$set(n),(!I||1&t)&&F!==(F="lines"===e[0].lineStyle?"Line width:":"Point size:")&&U(h,F);const r={};!p&&1&t&&(p=!0,r.value=e[0].thickness,ee((()=>p=!1))),m.$set(r),1&t&&O(E,e[0].lineStyle)},i(e){I||(de(o.$$.fragment,e),de(m.$$.fragment,e),I=!0)},o(e){me(o.$$.fragment,e),me(m.$$.fragment,e),I=!1},d(e){e&&$(t),be(o),be(m),N=!1,s(C)}}}function Rn(e){let t,n,r,i,o,a,l,c,u,h,d,m,p,f;const g=[wn,Sn,$n],v=[];function x(e,t){return e[1]?0:e[0]instanceof Rt?1:wt instanceof At?2:-1}return~(o=x(e))&&(a=v[o]=g[o](e)),{c(){t=w("div"),n=w("div"),r=w("input"),i=A(),a&&a.c(),l=A(),c=w("button"),u=w("i"),h=A(),d=w("button"),d.innerHTML='<i class="bi bi-x-circle svelte-1i1di7x"></i>',k(r,"type","color"),k(r,"class","color-picker svelte-1i1di7x"),N(r,"background-color",e[0].color),k(u,"class","bi bi-gear svelte-1i1di7x"),C(u,"active",e[1]),k(c,"id","settings-btn"),k(c,"class","svelte-1i1di7x"),k(d,"class","svelte-1i1di7x"),k(n,"id","row1"),k(n,"class","svelte-1i1di7x"),k(t,"id","container"),k(t,"class","svelte-1i1di7x")},m(s,a){b(s,t,a),y(t,n),y(n,r),I(r,e[0].color),y(n,i),~o&&v[o].m(n,null),y(n,l),y(n,c),y(c,u),y(n,h),y(n,d),m=!0,p||(f=[_(r,"input",e[5]),_(r,"input",e[3]),_(c,"click",e[12]),_(d,"click",e[13]),_(t,"keydown",e[14])],p=!0)},p(e,[t]){1&t&&I(r,e[0].color),1&t&&N(r,"background-color",e[0].color);let s=o;o=x(e),o===s?~o&&v[o].p(e,t):(a&&(ue(),me(v[s],1,1,(()=>{v[s]=null})),he()),~o?(a=v[o],a?a.p(e,t):(a=v[o]=g[o](e),a.c()),de(a,1),a.m(n,l)):a=null),(!m||2&t)&&C(u,"active",e[1])},i(e){m||(de(a),m=!0)},o(e){me(a),m=!1},d(e){e&&$(t),~o&&v[o].d(),p=!1,s(f)}}}function An(e,t,n){let r;c(e,mt,(e=>n(15,r=e)));let{shape:s}=t,{canvas:i}=t;const o=W();let a=!1;return e.$$set=e=>{"shape"in e&&n(0,s=e.shape),"canvas"in e&&n(4,i=e.canvas)},[s,a,o,function(e){s.setVertices(),mt.set(r),i.render()},i,function(){s.color=this.value,n(0,s)},function(t){e.$$.not_equal(s.numVerts,t)&&(s.numVerts=t,n(0,s))},function(t){e.$$.not_equal(s.thickness,t)&&(s.thickness=t,n(0,s))},function(){s.lineStyle=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(0,s)},function(t){e.$$.not_equal(s.x,t)&&(s.x=t,n(0,s))},function(t){e.$$.not_equal(s.y,t)&&(s.y=t,n(0,s))},function(t){e.$$.not_equal(s.r,t)&&(s.r=t,n(0,s))},()=>n(1,a=!a),()=>o("delete",s),e=>{"Enter"===e.key&&n(1,a=!1)}]}class Ln extends we{constructor(e){super(),Se(this,e,An,Rn,o,{shape:0,canvas:4})}}function _n(e,t,n){const r=e.slice();return r[7]=t[n],r}const kn=e=>({}),Tn=e=>({});function Un(e){let t,n,r,s=e[0],i=[];for(let t=0;t<s.length;t+=1)i[t]=In(_n(e,s,t));return{c(){t=w("div");for(let e=0;e<i.length;e+=1)i[e].c();k(t,"class","dropdown-inner svelte-u1mjs0")},m(e,n){b(e,t,n);for(let e=0;e<i.length;e+=1)i[e].m(t,null);r=!0},p(e,n){if(3&n){let r;for(s=e[0],r=0;r<s.length;r+=1){const o=_n(e,s,r);i[r]?i[r].p(o,n):(i[r]=In(o),i[r].c(),i[r].m(t,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=s.length}},i(e){r||(Z((()=>{n||(n=fe(t,jt,{duration:100},!0)),n.run(1)})),r=!0)},o(e){n||(n=fe(t,jt,{duration:100},!1)),n.run(0),r=!1},d(e){e&&$(t),S(i,e),e&&n&&n.end()}}}function In(e){let t,n,r,o,a=e[7].name+"";return{c(){t=w("button"),n=R(a),k(t,"class","dropdown-item svelte-u1mjs0")},m(s,a){b(s,t,a),y(t,n),r||(o=[_(t,"click",(function(){i(e[7].onClick)&&e[7].onClick.apply(this,arguments)})),_(t,"click",e[5])],r=!0)},p(t,r){e=t,1&r&&a!==(a=e[7].name+"")&&U(n,a)},d(e){e&&$(t),r=!1,s(o)}}}function Nn(e){let t,n,r,i,o,a;const l=e[3].trigger,c=function(e,t,n,r){if(e){const s=u(e,t,n,r);return e[0](s)}}(l,e,e[2],Tn);let h=e[1]&&Un(e);return{c(){t=w("div"),n=w("button"),c&&c.c(),r=A(),h&&h.c(),k(n,"class","svelte-u1mjs0"),k(t,"class","dropdown-container svelte-u1mjs0")},m(s,l){b(s,t,l),y(t,n),c&&c.m(n,null),y(t,r),h&&h.m(t,null),i=!0,o||(a=[_(n,"click",e[4]),_(t,"focusout",e[6])],o=!0)},p(e,[n]){c&&c.p&&(!i||4&n)&&function(e,t,n,r,s,i){if(s){const o=u(t,n,r,i);e.p(o,s)}}(c,l,e,e[2],i?function(e,t,n,r){if(e[2]&&r){const s=e[2](r(n));if(void 0===t.dirty)return s;if("object"==typeof s){const e=[],n=Math.max(t.dirty.length,s.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|s[r];return e}return t.dirty|s}return t.dirty}(l,e[2],n,kn):function(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}(e[2]),Tn),e[1]?h?(h.p(e,n),2&n&&de(h,1)):(h=Un(e),h.c(),de(h,1),h.m(t,null)):h&&(ue(),me(h,1,1,(()=>{h=null})),he())},i(e){i||(de(c,e),de(h),i=!0)},o(e){me(c,e),me(h),i=!1},d(e){e&&$(t),c&&c.d(e),h&&h.d(),o=!1,s(a)}}}function On(e,t,n){let{$$slots:r={},$$scope:s}=t,{items:i=[]}=t,o=!1;return e.$$set=e=>{"items"in e&&n(0,i=e.items),"$$scope"in e&&n(2,s=e.$$scope)},[i,o,s,r,()=>n(1,o=!o),()=>n(1,o=!1),e=>ft(e,(()=>n(1,o=!1)))]}class Cn extends we{constructor(e){super(),Se(this,e,On,Nn,o,{items:0})}}function Fn(e,t,n){const r=e.slice();return r[29]=t[n],r}function Mn(e,t,n){const r=e.slice();return r[32]=t[n],r}function Pn(e){let t,n,r,s;return n=new bn({props:{canvas:e[2]}}),{c(){t=w("div"),xe(n.$$.fragment),k(t,"id","controls-tab"),k(t,"class","svelte-1xd0vyr")},m(e,r){b(e,t,r),Ee(n,t,null),s=!0},p(t,r){e=t;const s={};4&r[0]&&(s.canvas=e[2]),n.$set(s)},i(e){s||(de(n.$$.fragment,e),Z((()=>{r||(r=fe(t,Gt,{x:-100,duration:qn},!0)),r.run(1)})),s=!0)},o(e){me(n.$$.fragment,e),r||(r=fe(t,Gt,{x:-100,duration:qn},!1)),r.run(0),s=!1},d(e){e&&$(t),be(n),e&&r&&r.end()}}}function Bn(n){let r,o,a,l,c,u,h,d,p,f,g,x,E,S,R,L,T,U,I;function N(e){n[17](e)}let O={canvas:n[2]};void 0!==n[1]&&(O.code=n[1]),a=new nn({props:O}),H.push((()=>ye(a,"code",N))),g=new Cn({props:{items:[{name:"Circle",onClick:n[20]},{name:"Line",onClick:n[21]},{name:"Custom",onClick:n[22]}],$$slots:{trigger:[Dn]},$$scope:{ctx:n}}});let C=n[4]?.length&&zn(n),F=n[5]?.length&&jn(n);return{c(){r=w("div"),o=w("div"),xe(a.$$.fragment),c=A(),u=w("div"),h=w("button"),h.innerHTML='<i class="bi bi-plus svelte-1xd0vyr"></i>Slider',d=A(),p=w("button"),p.innerHTML='<i class="bi bi-plus svelte-1xd0vyr"></i>Point',f=A(),xe(g.$$.fragment),x=A(),E=w("div"),C&&C.c(),S=A(),F&&F.c(),k(h,"class","add-object-btn svelte-1xd0vyr"),k(p,"class","add-object-btn svelte-1xd0vyr"),k(u,"id","buttons"),k(u,"class","svelte-1xd0vyr"),k(E,"id","variables-area"),k(o,"id","main-tab-inner"),k(o,"class","svelte-1xd0vyr"),k(r,"id","main-tab"),k(r,"class","svelte-1xd0vyr")},m(e,t){b(e,r,t),y(r,o),Ee(a,o,null),y(o,c),y(o,u),y(u,h),y(u,d),y(u,p),y(u,f),Ee(g,u,null),y(o,x),y(o,E),C&&C.m(E,null),y(E,S),F&&F.m(E,null),T=!0,U||(I=[_(h,"click",n[18]),_(p,"click",n[19]),_(r,"outrostart",pt)],U=!0)},p(e,t){n=e;const r={};4&t[0]&&(r.canvas=n[2]),!l&&2&t[0]&&(l=!0,r.code=n[1],ee((()=>l=!1))),a.$set(r);const s={};16&t[1]&&(s.$$scope={dirty:t,ctx:n}),g.$set(s),n[4]?.length?C?(C.p(n,t),16&t[0]&&de(C,1)):(C=zn(n),C.c(),de(C,1),C.m(E,S)):C&&(ue(),me(C,1,1,(()=>{C=null})),he()),n[5]?.length?F?(F.p(n,t),32&t[0]&&de(F,1)):(F=jn(n),F.c(),de(F,1),F.m(E,null)):F&&(ue(),me(F,1,1,(()=>{F=null})),he())},i(n){T||(de(a.$$.fragment,n),de(g.$$.fragment,n),de(C),de(F),Z((()=>{L&&L.end(1),R=function(n,r,s){const o={direction:"in"};let a,l,c=r(n,s,o),u=!1,h=0;function d(){a&&z(n,a)}function p(){const{delay:r=0,duration:s=300,easing:i=t,tick:o=e,css:p}=c||pe;p&&(a=D(n,0,1,s,r,i,p,h++)),o(0,1);const f=m()+r,g=f+s;l&&l.abort(),u=!0,Z((()=>ae(n,!0,"start"))),l=v((e=>{if(u){if(e>=g)return o(1,0),ae(n,!0,"end"),d(),u=!1;if(e>=f){const t=i((e-f)/s);o(t,1-t)}}return u}))}let f=!1;return{start(){f||(f=!0,z(n),i(c)?(c=c(o),oe().then(p)):p())},invalidate(){f=!1},end(){u&&(d(),u=!1)}}}(r,Gt,{x:-10,duration:qn}),R.start()})),T=!0)},o(n){me(a.$$.fragment,n),me(g.$$.fragment,n),me(C),me(F),R&&R.invalidate(),L=function(n,r,o){const a={direction:"out"};let l,c=r(n,o,a),u=!0;const h=ce;function d(){const{delay:r=0,duration:i=300,easing:o=t,tick:a=e,css:d}=c||pe;d&&(l=D(n,1,0,i,r,o,d));const p=m()+r,f=p+i;Z((()=>ae(n,!1,"start"))),v((e=>{if(u){if(e>=f)return a(0,1),ae(n,!1,"end"),--h.r||s(h.c),!1;if(e>=p){const t=o((e-p)/i);a(1-t,t)}}return u}))}return h.r+=1,i(c)?oe().then((()=>{c=c(a),d()})):d(),{end(e){e&&c.tick&&c.tick(1,0),u&&(l&&z(n,l),u=!1)}}}(r,Gt,{x:10,duration:qn}),T=!1},d(e){e&&$(r),be(a),be(g),C&&C.d(),F&&F.d(),e&&L&&L.end(),U=!1,s(I)}}}function Dn(t){let n;return{c(){n=w("button"),n.innerHTML='<i class="bi bi-plus svelte-1xd0vyr"></i>Shape',k(n,"slot","trigger"),k(n,"class","add-object-btn svelte-1xd0vyr")},m(e,t){b(e,n,t)},p:e,d(e){e&&$(n)}}}function zn(e){let t,n,r,s,i,o=[],a=new Map,l=e[4];const c=e=>e[32].id;for(let t=0;t<l.length;t+=1){let n=Mn(e,l,t),r=c(n);a.set(r,o[t]=Vn(r,n))}return{c(){t=w("h3"),t.textContent="Variables",r=A();for(let e=0;e<o.length;e+=1)o[e].c();s=L(),N(t,"margin","0 0 4px 0"),N(t,"font-size","1em"),N(t,"color","var(--c-white)")},m(e,n){b(e,t,n),b(e,r,n);for(let t=0;t<o.length;t+=1)o[t].m(e,n);b(e,s,n),i=!0},p(e,t){14352&t[0]&&(l=e[4],ue(),o=ve(o,t,c,1,e,l,a,s.parentNode,ge,Vn,s,Mn),he())},i(e){if(!i){Z((()=>{n||(n=fe(t,Wt,{},!0)),n.run(1)}));for(let e=0;e<l.length;e+=1)de(o[e]);i=!0}},o(e){n||(n=fe(t,Wt,{},!1)),n.run(0);for(let e=0;e<o.length;e+=1)me(o[e]);i=!1},d(e){e&&$(t),e&&n&&n.end(),e&&$(r);for(let t=0;t<o.length;t+=1)o[t].d(e);e&&$(s)}}}function Vn(e,t){let n,r,s,i,o;return r=new yn({props:{data:t[32]}}),r.$on("delete",t[23]),r.$on("nameChange",t[24]),r.$on("valueChange",t[25]),{key:e,first:null,c(){n=w("div"),xe(r.$$.fragment),s=A(),this.first=n},m(e,t){b(e,n,t),Ee(r,n,null),y(n,s),o=!0},p(e,n){t=e;const s={};16&n[0]&&(s.data=t[32]),r.$set(s)},i(e){o||(de(r.$$.fragment,e),Z((()=>{i||(i=fe(n,Wt,{duration:150},!0)),i.run(1)})),o=!0)},o(e){me(r.$$.fragment,e),i||(i=fe(n,Wt,{duration:150},!1)),i.run(0),o=!1},d(e){e&&$(n),be(r),e&&i&&i.end()}}}function jn(e){let t,n,r,s,i,o,a,l,c,u,h,d,m,p,f,g,v,x,E,S,R,T=[],U=new Map,I=e[5];const N=e=>e[29].id;for(let t=0;t<I.length;t+=1){let n=Fn(e,I,t),r=N(n);U.set(r,T[t]=Gn(r,n))}return{c(){t=w("div"),n=w("span"),n.textContent="Shapes",r=A(),s=w("div"),i=w("span"),i.textContent="Transform:",o=A(),a=w("span"),a.textContent="0",l=A(),c=w("input"),p=A(),f=w("span"),f.textContent="1",v=A();for(let e=0;e<T.length;e+=1)T[e].c();x=L(),k(c,"id","slider"),k(c,"type","range"),k(c,"min",u=0),k(c,"max",h=1),k(c,"step",d=.001),c.value=m=0,k(c,"class","svelte-1xd0vyr"),k(s,"class","slider-container svelte-1xd0vyr"),k(t,"class","shapes-header-row svelte-1xd0vyr")},m(u,h){b(u,t,h),y(t,n),y(t,r),y(t,s),y(s,i),y(s,o),y(s,a),y(s,l),y(s,c),y(s,p),y(s,f),b(u,v,h);for(let e=0;e<T.length;e+=1)T[e].m(u,h);b(u,x,h),E=!0,S||(R=_(c,"input",e[14]),S=!0)},p(e,t){1060&t[0]&&(I=e[5],ue(),T=ve(T,t,N,1,e,I,U,x.parentNode,ge,Gn,x,Fn),he())},i(e){if(!E){Z((()=>{g||(g=fe(t,Wt,{},!0)),g.run(1)}));for(let e=0;e<I.length;e+=1)de(T[e]);E=!0}},o(e){g||(g=fe(t,Wt,{},!1)),g.run(0);for(let e=0;e<T.length;e+=1)me(T[e]);E=!1},d(e){e&&$(t),e&&g&&g.end(),e&&$(v);for(let t=0;t<T.length;t+=1)T[t].d(e);e&&$(x),S=!1,R()}}}function Gn(e,t){let n,r,s,i,o;return r=new Ln({props:{shape:t[29],canvas:t[2]}}),r.$on("delete",t[26]),{key:e,first:null,c(){n=w("div"),xe(r.$$.fragment),s=A(),this.first=n},m(e,t){b(e,n,t),Ee(r,n,null),y(n,s),o=!0},p(e,n){t=e;const s={};32&n[0]&&(s.shape=t[29]),4&n[0]&&(s.canvas=t[2]),r.$set(s)},i(e){o||(de(r.$$.fragment,e),Z((()=>{i||(i=fe(n,Wt,{},!0)),i.run(1)})),o=!0)},o(e){me(r.$$.fragment,e),i||(i=fe(n,Wt,{},!1)),i.run(0),o=!1},d(e){e&&$(n),be(r),e&&i&&i.end()}}}function Wn(e){let t,n,r,s,i,o,a,l,c,u,h,d,m,p,f;function g(t){e[15](t)}let v={tabs:e[6]};void 0!==e[3]&&(v.activeTab=e[3]),r=new Ft({props:v}),H.push((()=>ye(r,"activeTab",g)));const x=[Bn,Pn],E=[];function S(e,t){return 1==e[3].id?0:2==e[3].id?1:-1}return~(h=S(e))&&(d=E[h]=x[h](e)),{c(){t=w("div"),n=w("div"),xe(r.$$.fragment),i=A(),o=w("button"),a=w("i"),c=A(),u=w("div"),d&&d.c(),k(a,"class",l="bi bi-chevron-double-"+(e[0]?"right":"left")+" svelte-1xd0vyr"),k(o,"id","btn-collapse"),k(o,"class","svelte-1xd0vyr"),k(n,"id","tab-area"),k(u,"id","below-tab-area"),k(u,"class","svelte-1xd0vyr"),k(t,"id","sidebar"),k(t,"class","svelte-1xd0vyr")},m(s,l){b(s,t,l),y(t,n),Ee(r,n,null),y(n,i),y(n,o),y(o,a),y(t,c),y(t,u),~h&&E[h].m(u,null),m=!0,p||(f=_(o,"click",e[16]),p=!0)},p(e,t){const n={};!s&&8&t[0]&&(s=!0,n.activeTab=e[3],ee((()=>s=!1))),r.$set(n),(!m||1&t[0]&&l!==(l="bi bi-chevron-double-"+(e[0]?"right":"left")+" svelte-1xd0vyr"))&&k(a,"class",l);let i=h;h=S(e),h===i?~h&&E[h].p(e,t):(d&&(ue(),me(E[i],1,1,(()=>{E[i]=null})),he()),~h?(d=E[h],d?d.p(e,t):(d=E[h]=x[h](e),d.c()),de(d,1),d.m(u,null)):d=null)},i(e){m||(de(r.$$.fragment,e),de(d),m=!0)},o(e){me(r.$$.fragment,e),me(d),m=!1},d(e){e&&$(t),be(r),~h&&E[h].d(),p=!1,f()}}}let qn=150;function Qn(e,t,n){let r,s;c(e,dt,(e=>n(4,r=e))),c(e,mt,(e=>n(5,s=e)));let{canvas:i}=t,{collapsed:o=!1}=t,{editorText:a=""}=t,l=W(),u=[{name:"Main",id:1},{name:"Settings",id:2}],d=u[0];function m(e){return r.some((t=>t.id!==e.id&&t.name===e.name))}function p(e="",t=0,n=-10,s=10,o=.001){h(dt,r=[...r,{id:St(),type:"float",name:e,value:t,min:n,max:s,step:o}],r),e.trim()&&i.addUniform(e,t,"float")}function f(e="",t=0,n=0,s=vt()){h(dt,r=[...r,{id:St(),type:"vec2",name:e,x:t,y:n,color:s}],r),e.trim()&&i.addUniform(e,[t,n],"vec2")}function g(e){let t;t=new Rt(0,0,1),h(mt,s=[...s,t],s),i.render()}function v(e){h(mt,s=s.filter((t=>t.id!==e.id)),s),i.render()}function y(e){h(dt,r=r.filter((t=>t.id!==e.id)),r),m(e)||(i.deleteUniform(e.name),i.compileUserCodeToGlsl(a,!0))}function x(e){dt.set(r),l("variableChange",e),e.name.trim()&&(i.setUniformValue(e.name,"float"===e.type?e.value:[e.x,e.y]),i.render())}function E(e){dt.set(r);let[t,n]=[e.prevName,e.data];t.trim()&&!r.some((e=>e.name===t&&e.id!==n.id))&&i.deleteUniform(t),m(n)?console.error("Duplicate name ",n.name):n.name.trim()&&("float"===n.type?i.addUniform(n.name,n.value,"float"):"vec2"===n.type&&i.addUniform(n.name,[n.x,n.y],"vec2")),i.compileUserCodeToGlsl(a,!0)}return e.$$set=e=>{"canvas"in e&&n(2,i=e.canvas),"collapsed"in e&&n(0,o=e.collapsed),"editorText"in e&&n(1,a=e.editorText)},[o,a,i,d,r,s,u,p,f,g,v,y,x,E,function(e){i.shapeProgram.setUniformValue("u_t",e.target.value),i.render()},function(e){d=e,n(3,d)},()=>n(0,o=!o),function(e){a=e,n(1,a)},e=>p(),e=>f(),()=>g(),()=>g(),()=>g(),e=>y(e.detail),e=>E(e.detail),e=>x(e.detail),e=>v(e.detail)]}class Hn extends we{constructor(e){super(),Se(this,e,Qn,Wn,o,{canvas:2,collapsed:0,editorText:1},null,[-1,-1])}}var Yn="undefined"!=typeof window?window:null,Xn=null===Yn,Kn=Xn?void 0:Yn.document,Jn="addEventListener",Zn="removeEventListener",er="getBoundingClientRect",tr="_a",nr="_b",rr="_c",sr="horizontal",ir=function(){return!1},or=Xn?"calc":["","-webkit-","-moz-","-o-"].filter((function(e){var t=Kn.createElement("div");return t.style.cssText="width:"+e+"calc(9px)",!!t.style.length})).shift()+"calc",ar=function(e){return"string"==typeof e||e instanceof String},lr=function(e){if(ar(e)){var t=Kn.querySelector(e);if(!t)throw new Error("Selector "+e+" did not match a DOM element");return t}return e},cr=function(e,t,n){var r=e[t];return void 0!==r?r:n},ur=function(e,t,n,r){if(t){if("end"===r)return 0;if("center"===r)return e/2}else if(n){if("start"===r)return 0;if("center"===r)return e/2}return e},hr=function(e,t){var n=Kn.createElement("div");return n.className="gutter gutter-"+t,n},dr=function(e,t,n){var r={};return ar(t)?r[e]=t:r[e]=or+"("+t+"% - "+n+"px)",r},mr=function(e,t){var n;return(n={})[e]=t+"px",n},pr=function(e,t){if(void 0===t&&(t={}),Xn)return{};var n,r,s,i,o,a,l=e;Array.from&&(l=Array.from(l));var c=lr(l[0]).parentNode,u=getComputedStyle?getComputedStyle(c):null,h=u?u.flexDirection:null,d=cr(t,"sizes")||l.map((function(){return 100/l.length})),m=cr(t,"minSize",100),p=Array.isArray(m)?m:l.map((function(){return m})),f=cr(t,"maxSize",1/0),g=Array.isArray(f)?f:l.map((function(){return f})),v=cr(t,"expandToMin",!1),y=cr(t,"gutterSize",10),x=cr(t,"gutterAlign","center"),E=cr(t,"snapOffset",30),b=Array.isArray(E)?E:l.map((function(){return E})),$=cr(t,"dragInterval",1),S=cr(t,"direction",sr),w=cr(t,"cursor",S===sr?"col-resize":"row-resize"),R=cr(t,"gutter",hr),A=cr(t,"elementStyle",dr),L=cr(t,"gutterStyle",mr);function _(e,t,r,s){var i=A(n,t,r,s);Object.keys(i).forEach((function(t){e.style[t]=i[t]}))}function k(){return a.map((function(e){return e.size}))}function T(e){return"touches"in e?e.touches[0][r]:e[r]}function U(e){var t=a[this.a],n=a[this.b],r=t.size+n.size;t.size=e/this.size*r,n.size=r-e/this.size*r,_(t.element,t.size,this[nr],t.i),_(n.element,n.size,this[rr],n.i)}function I(e){var n,r=a[this.a],s=a[this.b];this.dragging&&(n=T(e)-this.start+(this[nr]-this.dragOffset),$>1&&(n=Math.round(n/$)*$),n<=r.minSize+r.snapOffset+this[nr]?n=r.minSize+this[nr]:n>=this.size-(s.minSize+s.snapOffset+this[rr])&&(n=this.size-(s.minSize+this[rr])),n>=r.maxSize-r.snapOffset+this[nr]?n=r.maxSize+this[nr]:n<=this.size-(s.maxSize-s.snapOffset+this[rr])&&(n=this.size-(s.maxSize+this[rr])),U.call(this,n),cr(t,"onDrag",ir)(k()))}function N(){var e=a[this.a].element,t=a[this.b].element,r=e[er](),o=t[er]();this.size=r[n]+o[n]+this[nr]+this[rr],this.start=r[s],this.end=r[i]}function O(e){var t=function(e){if(!getComputedStyle)return null;var t=getComputedStyle(e);if(!t)return null;var n=e[o];return 0===n?null:n-=S===sr?parseFloat(t.paddingLeft)+parseFloat(t.paddingRight):parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)}(c);if(null===t)return e;if(p.reduce((function(e,t){return e+t}),0)>t)return e;var n=0,r=[],s=e.map((function(s,i){var o=t*s/100,a=ur(y,0===i,i===e.length-1,x),l=p[i]+a;return o<l?(n+=l-o,r.push(0),l):(r.push(o-l),o)}));return 0===n?e:s.map((function(e,s){var i=e;if(n>0&&r[s]-n>0){var o=Math.min(n,r[s]-n);n-=o,i=e-o}return i/t*100}))}function C(){var e=this,n=a[e.a].element,r=a[e.b].element;e.dragging&&cr(t,"onDragEnd",ir)(k()),e.dragging=!1,Yn[Zn]("mouseup",e.stop),Yn[Zn]("touchend",e.stop),Yn[Zn]("touchcancel",e.stop),Yn[Zn]("mousemove",e.move),Yn[Zn]("touchmove",e.move),e.stop=null,e.move=null,n[Zn]("selectstart",ir),n[Zn]("dragstart",ir),r[Zn]("selectstart",ir),r[Zn]("dragstart",ir),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",e.gutter.style.cursor="",e.parent.style.cursor="",Kn.body.style.cursor=""}function F(e){if(!("button"in e)||0===e.button){var n=this,r=a[n.a].element,s=a[n.b].element;n.dragging||cr(t,"onDragStart",ir)(k()),e.preventDefault(),n.dragging=!0,n.move=I.bind(n),n.stop=C.bind(n),Yn[Jn]("mouseup",n.stop),Yn[Jn]("touchend",n.stop),Yn[Jn]("touchcancel",n.stop),Yn[Jn]("mousemove",n.move),Yn[Jn]("touchmove",n.move),r[Jn]("selectstart",ir),r[Jn]("dragstart",ir),s[Jn]("selectstart",ir),s[Jn]("dragstart",ir),r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",s.style.userSelect="none",s.style.webkitUserSelect="none",s.style.MozUserSelect="none",s.style.pointerEvents="none",n.gutter.style.cursor=w,n.parent.style.cursor=w,Kn.body.style.cursor=w,N.call(n),n.dragOffset=T(e)-n.end}}S===sr?(n="width",r="clientX",s="left",i="right",o="clientWidth"):"vertical"===S&&(n="height",r="clientY",s="top",i="bottom",o="clientHeight"),d=O(d);var M=[];function P(e){var t=e.i===M.length,n=t?M[e.i-1]:M[e.i];N.call(n);var r=t?n.size-e.minSize-n[rr]:e.minSize+n[nr];U.call(n,r)}return a=l.map((function(e,t){var r,s={element:lr(e),size:d[t],minSize:p[t],maxSize:g[t],snapOffset:b[t],i:t};if(t>0&&((r={a:t-1,b:t,dragging:!1,direction:S,parent:c})[nr]=ur(y,t-1==0,!1,x),r[rr]=ur(y,!1,t===l.length-1,x),"row-reverse"===h||"column-reverse"===h)){var i=r.a;r.a=r.b,r.b=i}if(t>0){var o=R(t,S,s.element);!function(e,t,r){var s=L(n,t,r);Object.keys(s).forEach((function(t){e.style[t]=s[t]}))}(o,y,t),r[tr]=F.bind(r),o[Jn]("mousedown",r[tr]),o[Jn]("touchstart",r[tr]),c.insertBefore(o,s.element),r.gutter=o}return _(s.element,s.size,ur(y,0===t,t===l.length-1,x),t),t>0&&M.push(r),s})),a.forEach((function(e){var t=e.element[er]()[n];t<e.minSize&&(v?P(e):e.minSize=t)})),{setSizes:function(e){var t=O(e);t.forEach((function(e,n){if(n>0){var r=M[n-1],s=a[r.a],i=a[r.b];s.size=t[n-1],i.size=e,_(s.element,s.size,r[nr],s.i),_(i.element,i.size,r[rr],i.i)}}))},getSizes:k,collapse:function(e){P(a[e])},destroy:function(e,t){M.forEach((function(r){if(!0!==t?r.parent.removeChild(r.gutter):(r.gutter[Zn]("mousedown",r[tr]),r.gutter[Zn]("touchstart",r[tr])),!0!==e){var s=A(n,r.a.size,r[nr]);Object.keys(s).forEach((function(e){a[r.a].element.style[e]="",a[r.b].element.style[e]=""}))}}))},parent:c,pairs:M}};function fr(t){let n,r,i,o;return{c(){n=w("div"),r=w("div"),k(r,"id","point"),N(r,"width",gr+"px"),N(r,"height",gr+"px"),N(r,"background-color",t[0].color),k(r,"class","svelte-1cg09kd"),C(r,"dragging",t[1]),k(n,"id","container"),N(n,"left",t[2].x+"px"),N(n,"top",t[2].y+"px"),k(n,"class","svelte-1cg09kd")},m(e,s){var a;b(e,n,s),y(n,r),i||(o=[_(r,"mousedown",t[5]),_(r,"mouseup",t[6]),_(r,"mousemove",(a=t[3],function(e){return e.stopPropagation(),a.call(this,e)}))],i=!0)},p(e,[t]){1&t&&N(r,"background-color",e[0].color),2&t&&C(r,"dragging",e[1]),4&t&&N(n,"left",e[2].x+"px"),4&t&&N(n,"top",e[2].y+"px")},i:e,o:e,d(e){e&&$(n),i=!1,s(o)}}}let gr=20;function vr(e,t,n){let r;c(e,dt,(e=>n(7,r=e)));let{canvas:s}=t,{data:i}=t,o=!1,a=s.camera.worldToScreen(i.x,i.y);function l(e){if(!o)return;const t=s.c.getBoundingClientRect();let[l,c]=[e.clientX-t.left,e.clientY-t.top];n(2,a={x:l-gr/2,y:c-gr/2});let u=s.camera.screenToWorld(l,c);n(0,i.x=u.x,i),n(0,i.y=u.y,i),dt.set(r),i.name.trim()&&(s.setUniformValue(i.name,[i.x,i.y]),s.render())}a={x:a.x-gr/2,y:a.y-gr/2},s.c.addEventListener("mouseup",(e=>{n(1,o=!1)})),s.c.addEventListener("mousemove",l);return e.$$set=e=>{"canvas"in e&&n(4,s=e.canvas),"data"in e&&n(0,i=e.data)},[i,o,a,l,s,()=>n(1,o=!0),()=>{n(1,o=!1)}]}class yr extends we{constructor(e){super(),Se(this,e,vr,fr,o,{canvas:4,data:0})}}function xr(e,t,n){const r=e.slice();return r[24]=t[n],r}function Er(e){let t,n,r;function s(t){e[13](t)}let i={canvas:e[1],editorText:e[11].code};return void 0!==e[0]&&(i.collapsed=e[0]),t=new Hn({props:i}),H.push((()=>ye(t,"collapsed",s))),t.$on("variableChange",e[14]),{c(){xe(t.$$.fragment)},m(e,n){Ee(t,e,n),r=!0},p(e,r){const s={};2&r&&(s.canvas=e[1]),!n&&1&r&&(n=!0,s.collapsed=e[0],ee((()=>n=!1))),t.$set(s)},i(e){r||(de(t.$$.fragment,e),r=!0)},o(e){me(t.$$.fragment,e),r=!1},d(e){be(t,e)}}}function br(t){let n,r,s;return{c(){n=w("button"),n.innerHTML='<i class="bi bi-chevron-double-right svelte-fdv3nm"></i>',k(n,"id","expand-btn"),k(n,"class","svelte-fdv3nm")},m(e,i){b(e,n,i),r||(s=_(n,"click",t[16]),r=!0)},p:e,d(e){e&&$(n),r=!1,s()}}}function $r(t){let n,r,s=[t[4],t[5]],i=Rr(t);return{c(){i.c(),n=L()},m(e,t){i.m(e,t),b(e,n,t),r=!0},p(t,r){48&r&&o(s,s=[t[4],t[5]])?(ue(),me(i,1,1,e),he(),i=Rr(t),i.c(),de(i,1),i.m(n.parentNode,n)):i.p(t,r)},i(e){r||(de(i),r=!0)},o(e){me(i),r=!1},d(e){e&&$(n),i.d(e)}}}function Sr(e){let t,n;return t=new yr({props:{canvas:e[1],data:e[24]}}),{c(){xe(t.$$.fragment)},m(e,r){Ee(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.canvas=e[1]),1024&n&&(r.data=e[24]),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){me(t.$$.fragment,e),n=!1},d(e){be(t,e)}}}function wr(e,t){let n,r,s,i="vec2"===t[24].type&&Sr(t);return{key:e,first:null,c(){n=L(),i&&i.c(),r=L(),this.first=n},m(e,t){b(e,n,t),i&&i.m(e,t),b(e,r,t),s=!0},p(e,n){"vec2"===(t=e)[24].type?i?(i.p(t,n),1024&n&&de(i,1)):(i=Sr(t),i.c(),de(i,1),i.m(r.parentNode,r)):i&&(ue(),me(i,1,1,(()=>{i=null})),he())},i(e){s||(de(i),s=!0)},o(e){me(i),s=!1},d(e){e&&$(n),i&&i.d(e),e&&$(r)}}}function Rr(e){let t,n,r=[],s=new Map,i=e[10];const o=e=>e[24].id;for(let t=0;t<i.length;t+=1){let n=xr(e,i,t),a=o(n);s.set(a,r[t]=wr(a,n))}return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=L()},m(e,s){for(let t=0;t<r.length;t+=1)r[t].m(e,s);b(e,t,s),n=!0},p(e,n){1026&n&&(i=e[10],ue(),r=ve(r,n,o,1,e,i,s,t.parentNode,ge,wr,t,xr),he())},i(e){if(!n){for(let e=0;e<i.length;e+=1)de(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)me(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&$(t)}}}function Ar(e){let t,n;return t=new Ut({props:{canvas:e[1],mouse:e[3],fval:e[1].computeFval(e[3])}}),{c(){xe(t.$$.fragment)},m(e,r){Ee(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.canvas=e[1]),8&n&&(r.mouse=e[3]),10&n&&(r.fval=e[1].computeFval(e[3])),t.$set(r)},i(e){n||(de(t.$$.fragment,e),n=!0)},o(e){me(t.$$.fragment,e),n=!1},d(e){be(t,e)}}}function Lr(e){let t,n,r,s,i,o,a,l,c,u=e[2]&&Er(e),h=e[0]&&e[9]&&br(e),d=e[2]&&e[9]&&$r(e),m=e[2]&&e[9]&&Ar(e);return{c(){t=w("main"),n=w("div"),u&&u.c(),r=A(),s=w("div"),h&&h.c(),i=A(),o=w("canvas"),a=A(),d&&d.c(),l=A(),m&&m.c(),k(n,"id","sidebar-div"),k(n,"class","svelte-fdv3nm"),N(n,"display",e[0]?"none":"block"),k(o,"class","svelte-fdv3nm"),k(s,"id","canvas-div"),k(s,"class","svelte-fdv3nm"),k(t,"class","svelte-fdv3nm")},m(p,f){b(p,t,f),y(t,n),u&&u.m(n,null),e[15](n),y(t,r),y(t,s),h&&h.m(s,null),y(s,i),y(s,o),e[17](o),y(s,a),d&&d.m(s,null),e[18](s),y(t,l),m&&m.m(t,null),c=!0},p(e,[r]){e[2]?u?(u.p(e,r),4&r&&de(u,1)):(u=Er(e),u.c(),de(u,1),u.m(n,null)):u&&(ue(),me(u,1,1,(()=>{u=null})),he()),1&r&&N(n,"display",e[0]?"none":"block"),e[0]&&e[9]?h?h.p(e,r):(h=br(e),h.c(),h.m(s,i)):h&&(h.d(1),h=null),e[2]&&e[9]?d?(d.p(e,r),516&r&&de(d,1)):(d=$r(e),d.c(),de(d,1),d.m(s,null)):d&&(ue(),me(d,1,1,(()=>{d=null})),he()),e[2]&&e[9]?m?(m.p(e,r),516&r&&de(m,1)):(m=Ar(e),m.c(),de(m,1),m.m(t,null)):m&&(ue(),me(m,1,1,(()=>{m=null})),he())},i(e){c||(de(u),de(d),de(m),c=!0)},o(e){me(u),me(d),me(m),c=!1},d(n){n&&$(t),u&&u.d(),e[15](null),h&&h.d(),e[17](null),d&&d.d(),e[18](null),m&&m.d()}}}function _r(e,t,n){let r,s;c(e,ht,(e=>n(22,r=e))),c(e,dt,(e=>n(10,s=e)));var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function a(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};let o,a,l,u,h,d,m=!1,p={x:0,y:0},f=!1,g=!1,v=!1,y=!1,x=[40,60],E=!0,b=Dt[zt];G((()=>i(void 0,void 0,void 0,(function*(){n(12,d=pr(["#sidebar-div","#canvas-div"],{sizes:x,minSize:[380,250],gutterSize:5,gutterAlign:"start",onDragEnd:()=>{x=d.getSizes()}})),h=document.querySelector(".gutter"),n(1,o=new Lt(u,b)),r.length>0?console.error("error in default workspace code: ",r[0].toString()):yield o.init((e=>console.error(e))),n(2,m=!0),u.addEventListener("mousedown",(e=>v=!0)),u.addEventListener("mouseup",(e=>v=!1)),u.addEventListener("mouseleave",(e=>v=!1)),u.addEventListener("mousemove",(e=>{v&&o.camera.move(e.movementX,e.movementY),n(3,p=o.camera.screenToWorld(e.offsetX,e.offsetY)),n(1,o.mousePos=p,o)})),l.addEventListener("wheel",(e=>{e.preventDefault();const t=u.getBoundingClientRect(),[n,r]=[e.clientX-t.left,e.clientY-t.top];o.camera.scaleAt(n,r,Math.pow(1.001,e.deltaY))})),u.addEventListener("camera",(e=>{n(4,f=!f),o.render()})),document.addEventListener("keydown",(e=>{if(document.activeElement===document.body)switch(e.key){case"h":o.camera.reset();break;case"u":n(9,E=!E),n(0,y=!E)}})),new ResizeObserver((()=>{Te(u),n(1,o.camera.scale.x=o.camera.scale.y*o.camera.aspect(),o),n(4,f=!f),o.render()})).observe(u)}))));return e.$$.update=()=>{4097&e.$$.dirty&&d&&(h.style.display=y?"none":"block")},[y,o,m,p,f,g,a,l,u,E,s,b,d,function(e){y=e,n(0,y)},e=>{"vec2"===e.detail.type&&n(5,g=!g)},function(e){H[e?"unshift":"push"]((()=>{a=e,n(6,a)}))},()=>n(0,y=!1),function(e){H[e?"unshift":"push"]((()=>{u=e,n(8,u)}))},function(e){H[e?"unshift":"push"]((()=>{l=e,n(7,l)}))}]}return new class extends we{constructor(e){super(),Se(this,e,_r,Lr,o,{})}}({target:document.body,props:{}})}();
